/*
 * MoveAction.h
 *
 *  Created on: 2016/11/11
 *      Author: kerikun11
 */

#ifndef MOVEACTION_H_
#define MOVEACTION_H_

#include "mbed.h"
#include "config.h"
#include <vector>
#include <queue>

#define MOVE_ACTION_PERIOD			1000
#define WALL_ATTACH_ENABLED			false
#define WALL_AVOID_ENABLED			false

//#define LOOK_AHEAD_UNIT				10
//#define DETERMINE_VELOCITY_UNIT		10
#define TRAJECTORY_PROP_GAIN		20
#define TRAJECTORY_INT_GAIN			10

class Trajectory {
public:
	Trajectory() {
		reset();
	}
	virtual ~Trajectory() {
	}
	void reset() {
		last_index = 0;
	}
	Position getNextDir(const Position &cur, float velocity) {
		int index_cur = getNextIndex(cur);
		int look_ahead = 30;
		Position dir = (getPosition(index_cur + look_ahead) - cur).rotate(-cur.theta);
		dir.theta = atan2f(dir.y, dir.x);
		dir *= velocity / look_ahead;
		return dir;
	}
	float getRemain() const {
		return (getSize() - last_index) * interval;
	}
	Position getEndPosition() {
		return getPosition(getSize());
	}
protected:
	int last_index;
	const float interval = 1.0f;
	virtual int size() const {
		return 180;
	}
	virtual Position position(int index) const {
		return Position(index * interval, 0, 0);
	}
	virtual void cache(int index) {
	}
	int getSize() const {
		return size();
	}
	Position getPosition(const int index) {
		return position(index);
	}
	int getNextIndex(const Position& pos) {
		for (int i = last_index;; i++) {
			Position target = getPosition(i);
			Position dir = (target - pos).rotate(-target.theta);
			if (dir.x > 0) {
				last_index = i;
				cache(last_index);
				return last_index;
			}
		}
		return last_index;
	}
};

//class FastTrajectory {
//public:
//	enum CURVE {
//		LEFT_45, RIGHT_45, LEFT_45_45, RIGHT_45_45, LEFT_90, RIGHT_90, LEFT_135, RIGHT_135, LEFT_180, RIGHT_180,
//	};
//	Position get(const enum CURVE action, int index) const {
//		if (index < 0) {
//			return Position(0 + interval * index, 0, 0);
//		} else if (index > size(action) - 1) {
//			int extra = index - size(action) + 1;
//			Position end = endPosition(action);
//			return end + Position(extra * interval * cos(end.theta), extra * interval * sin(end.theta), 0);
//		} else {
//			return point(action, index);
//		}
//	}
//	int size(const enum CURVE action) const {
//		switch (action) {
//		case LEFT_45:
//		case RIGHT_45:
//			return 175;
//		case LEFT_45_45:
//		case RIGHT_45_45:
//			return 218;
//		case LEFT_90:
//		case RIGHT_90:
//			return 155;
//		case LEFT_135:
//		case RIGHT_135:
//			return 219;
//		case LEFT_180:
//		case RIGHT_180:
//			return 464;
//		default:
//			return 180;
//		}
//	}
//	Position endPosition(const enum CURVE action) const {
//		switch (action) {
////		case FAST_GO_STRAIGHT:
////			return Position(180);
////		case FAST_GO_HALF:
////			return Position(90);
////		case FAST_GO_DIAGONAL:
////			return Position(63.639610306789280);
////		case FAST_GO_45:
////			return Position(37.280794107585571);
////		case FAST_GO_135:
////			return Position(74.560731431502333);
//
//		case LEFT_45:
//		case RIGHT_45:
//		case LEFT_45_45:
//		case RIGHT_45_45:
//		case LEFT_90:
//		case RIGHT_90:
//		case LEFT_135:
//		case RIGHT_135:
//		case LEFT_180:
//		case RIGHT_180:
//			return point(action, size(action) - 1);
//		default:
//			return Position();
//		}
//	}
//	inline float velocity(const enum CURVE action) const {
//		return 600;
////		switch (action) {
////		case LEFT_45:
////		case RIGHT_45:
////			return 2088.974325267867;
////		case LEFT_45_45:
////		case RIGHT_45_45:
////			return 1306.700000000000;
////		case LEFT_90:
////		case RIGHT_90:
////			return 924.0000000000000;
////		case LEFT_135:
////		case RIGHT_135:
////			return 875.2491192303874;
////		case LEFT_180:
////		case RIGHT_180:
////			return 1389.450507951041;
////		}
//	}
//private:
//	const float interval = 1.0f;
//	Position point(const enum CURVE action, const int index) const {
//		static const Position data_45[175] =
//				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000024, 0.00000095 }, { 2.00000000, 0.00000388, 0.00000772 }, { 3.00000000, 0.00001970, 0.00002617 }, { 4.00000000, 0.00006234, 0.00006216 }, { 4.99999999, 0.00015228, 0.00012152 }, { 5.99999998, 0.00031584, 0.00021004 }, { 6.99999994, 0.00058507, 0.00033350 }, { 7.99999986, 0.00099782, 0.00049760 }, { 8.99999968, 0.00159758, 0.00070800 }, { 9.99999932, 0.00243349, 0.00097032 }, { 10.99999868, 0.00356028, 0.00129009 }, { 11.99999759, 0.00503815, 0.00167276 }, { 12.99999578, 0.00693272, 0.00212371 }, { 13.99999293, 0.00931497, 0.00264824 }, { 14.99998858, 0.01226110, 0.00325154 }, { 15.99998211, 0.01585245, 0.00393870 }, { 16.99997274, 0.02017540, 0.00471469 }, { 17.99995947, 0.02532127, 0.00558440 }, { 18.99994104, 0.03138615, 0.00655255 }, { 19.99991589, 0.03847083, 0.00762378 }, { 20.99988214, 0.04668065, 0.00880255 }, { 21.99983746, 0.05612534, 0.01009321 }, { 22.99977913, 0.06691890, 0.01149995 }, { 23.99970387, 0.07917944, 0.01302683 }, { 24.99960785, 0.09302903, 0.01467772 }, { 25.99948658, 0.10859354, 0.01645636 }, { 26.99933488, 0.12600245, 0.01836630 }, { 27.99914677, 0.14538871, 0.02041093 }, { 28.99891543, 0.16688854, 0.02259347 }, { 29.99863307, 0.19064127, 0.02491695 }, { 30.99829090, 0.21678911, 0.02738423 }, { 31.99787903, 0.24547701, 0.02999795 }, { 32.99738638, 0.27685244, 0.03276061 }, { 33.99680060, 0.31106517, 0.03567446 }, { 34.99610798, 0.34826708, 0.03874161 }, { 35.99529336, 0.38861198, 0.04196392 }, { 36.99434006, 0.43225535, 0.04534308 }, { 37.99322977, 0.47935415, 0.04888056 }, { 38.99194250, 0.53006660, 0.05257763 }, { 39.99045645, 0.58455192, 0.05643535 }, { 40.98874797, 0.64297018, 0.06045458 }, { 41.98679146, 0.70548199, 0.06463595 }, { 42.98455931, 0.77224832, 0.06897990 }, { 43.98202181, 0.84343025, 0.07348665 }, { 44.97914710, 0.91918873, 0.07815619 }, { 45.97590109, 0.99968435, 0.08298833 }, { 46.97224741, 1.08507711, 0.08798265 }, { 47.96814738, 1.17552615, 0.09313851 }, { 48.96355994, 1.27118956, 0.09845509 }, { 49.95844160, 1.37222408, 0.10393133 }, { 50.95274646, 1.47878491, 0.10956597 }, { 51.94642612, 1.59102545, 0.11535755 }, { 52.93942971, 1.70909706, 0.12130441 }, { 53.93170390, 1.83314882, 0.12740468 }, { 54.92319283, 1.96332732, 0.13365628 }, { 55.91383820, 2.09977639, 0.14005695 }, { 56.90357922, 2.24263689, 0.14660424 }, { 57.89235273, 2.39204649, 0.15329547 }, { 58.88009313, 2.54813945, 0.16012783 }, { 59.86673252, 2.71104635, 0.16709828 }, { 60.85220073, 2.88089395, 0.17420363 }, { 61.83642536, 3.05780493, 0.18144049 }, { 62.81933193, 3.24189772, 0.18880532 }, { 63.80084391, 3.43328627, 0.19629439 }, { 64.78088282, 3.63207987, 0.20390383 }, { 65.75936841, 3.83838301, 0.21162961 }, { 66.73621869, 4.05229513, 0.21946754 }, { 67.71135015, 4.27391052, 0.22741328 }, { 68.68467782, 4.50331812, 0.23546236 }, { 69.65611547, 4.74060141, 0.24361018 }, { 70.62557576, 4.98583821, 0.25185200 }, { 71.59297038, 5.23910064, 0.26018295 }, { 72.55821027, 5.50045492, 0.26859807 }, { 73.52120575, 5.76996132, 0.27709227 }, { 74.48186674, 6.04767402, 0.28566036 }, { 75.44010295, 6.33364107, 0.29429706 }, { 76.39582406, 6.62790429, 0.30299699 }, { 77.34893997, 6.93049920, 0.31175470 }, { 78.29936093, 7.24145503, 0.32056466 }, { 79.24699783, 7.56079462, 0.32942127 }, { 80.19176236, 7.88853441, 0.33831887 }, { 81.13356727, 8.22468447, 0.34725175 }, { 82.07232653, 8.56924848, 0.35621414 }, { 83.00795560, 8.92222372, 0.36520026 }, { 83.94037161, 9.28360114, 0.37420426 }, { 84.86949358, 9.65336538, 0.38322031 }, { 85.79524265, 10.03149481, 0.39224253 }, { 86.71754228, 10.41796165, 0.40126504 }, { 87.63631843, 10.81273197, 0.41028198 }, { 88.55149980, 11.21576583, 0.41928747 }, { 89.46301800, 11.62701739, 0.42827566 }, { 90.37080774, 12.04643496, 0.43724072 }, { 91.27480700, 12.47396119, 0.44617685 }, { 92.17495724, 12.90953317, 0.45507828 }, { 93.07120352, 13.35308256, 0.46393929 }, { 93.96349469, 13.80453576, 0.47275423 }, { 94.85178353, 14.26381404, 0.48151748 }, { 95.73602685, 14.73083377, 0.49022351 }, { 96.61618569, 15.20550650, 0.49886685 }, { 97.49222534, 15.68773923, 0.50744213 }, { 98.36411553, 16.17743452, 0.51594404 }, { 99.23183046, 16.67449073, 0.52436740 }, { 100.09534893, 17.17880220, 0.53270710 }, { 100.95465435, 17.69025946, 0.54095816 }, { 101.80973483, 18.20874940, 0.54911570 }, { 102.66058323, 18.73415552, 0.55717499 }, { 103.50719715, 19.26635811, 0.56513139 }, { 104.34957898, 19.80523446, 0.57298043 }, { 105.18773589, 20.35065908, 0.58071775 }, { 106.02167980, 20.90250391, 0.58833915 }, { 106.85142739, 21.46063852, 0.59584059 }, { 107.67700005, 22.02493032, 0.60321816 }, { 108.49842382, 22.59524481, 0.61046813 }, { 109.31572934, 23.17144570, 0.61758694 }, { 110.12895177, 23.75339520, 0.62457119 }, { 110.93813071, 24.34095417, 0.63141767 }, { 111.74331010, 24.93398233, 0.63812332 }, { 112.54453813, 25.53233846, 0.64468529 }, { 113.34186707, 26.13588061, 0.65110091 }, { 114.13535322, 26.74446623, 0.65736771 }, { 114.92505670, 27.35795241, 0.66348338 }, { 115.71104135, 27.97619603, 0.66944586 }, { 116.49337454, 28.59905394, 0.67525323 }, { 117.27212704, 29.22638311, 0.68090383 }, { 118.04737281, 29.85804084, 0.68639615 }, { 118.81918886, 30.49388486, 0.69172894 }, { 119.58765503, 31.13377352, 0.69690111 }, { 120.35285385, 31.77756595, 0.70191181 }, { 121.11487026, 32.42512215, 0.70676038 }, { 121.87379149, 33.07630317, 0.71144639 }, { 122.62970683, 33.73097126, 0.71596961 }, { 123.38270738, 34.38898994, 0.72033003 }, { 124.13288592, 35.05022416, 0.72452784 }, { 124.88033660, 35.71454044, 0.72856345 }, { 125.62515481, 36.38180694, 0.73243748 }, { 126.36743692, 37.05189360, 0.73615076 }, { 127.10728005, 37.72467223, 0.73970434 }, { 127.84478191, 38.40001662, 0.74309945 }, { 128.58004051, 39.07780267, 0.74633756 }, { 129.31315399, 39.75790841, 0.74942033 }, { 130.04422043, 40.44021417, 0.75234961 }, { 130.77333755, 41.12460265, 0.75512746 }, { 131.50060259, 41.81095896, 0.75775615 }, { 132.22611206, 42.49917076, 0.76023812 }, { 132.94996156, 43.18912833, 0.76257603 }, { 133.67224554, 43.88072464, 0.76477270 }, { 134.39305716, 44.57385541, 0.76683114 }, { 135.11248804, 45.26841922, 0.76875456 }, { 135.83062814, 45.96431759, 0.77054633 }, { 136.54756553, 46.66145498, 0.77220998 }, { 137.26338623, 47.35973896, 0.77374923 }, { 137.97817407, 48.05908021, 0.77516795 }, { 138.69201047, 48.75939261, 0.77647017 }, { 139.40497433, 49.46059331, 0.77766007 }, { 140.11714188, 50.16260276, 0.77874197 }, { 140.82858652, 50.86534485, 0.77972035 }, { 141.53937870, 51.56874688, 0.78059980 }, { 142.24958576, 52.27273969, 0.78138506 }, { 142.95927187, 52.97725768, 0.78208099 }, { 143.66849785, 53.68223887, 0.78269254 }, { 144.37732111, 54.38762498, 0.78322481 }, { 145.08579554, 55.09336145, 0.78368297 }, { 145.79397141, 55.79939751, 0.78407231 }, { 146.50189529, 56.50568625, 0.78439819 }, { 147.20960998, 57.21218459, 0.78466607 }, { 147.91715445, 57.91885341, 0.78488148 }, { 148.62456374, 58.62565755, 0.78505000 }, { 149.33186896, 59.33256583, 0.78517731 }, { 150.03909719, 60.03955114, 0.78526911 }, { 150.74627148, 60.74659040, 0.78533116 }, { 151.45341080, 61.45366465, 0.78536925 }, { 152.16053001, 62.16075900, 0.78538921 }, { 152.86763983, 62.86786275, 0.78539689 }, { 153.63838646, 63.63860890, 0.78539816 }, };
//		static const Position data_45_45[218] =
//				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000025, 0.00000097 }, { 2.00000000, 0.00000396, 0.00000788 }, { 3.00000000, 0.00002012, 0.00002674 }, { 4.00000000, 0.00006369, 0.00006352 }, { 4.99999999, 0.00015561, 0.00012420 }, { 5.99999998, 0.00032279, 0.00021473 }, { 6.99999994, 0.00059807, 0.00034104 }, { 7.99999985, 0.00102023, 0.00050903 }, { 8.99999966, 0.00163389, 0.00072456 }, { 9.99999929, 0.00248956, 0.00099345 }, { 10.99999862, 0.00364350, 0.00132149 }, { 11.99999747, 0.00515777, 0.00171440 }, { 12.99999557, 0.00710011, 0.00217787 }, { 13.99999258, 0.00954391, 0.00271750 }, { 14.99998799, 0.01256814, 0.00333885 }, { 15.99998116, 0.01625732, 0.00404741 }, { 16.99997126, 0.02070137, 0.00484859 }, { 17.99995721, 0.02599562, 0.00574773 }, { 18.99993767, 0.03224068, 0.00675008 }, { 19.99991096, 0.03954237, 0.00786081 }, { 20.99987503, 0.04801164, 0.00908500 }, { 21.99982740, 0.05776444, 0.01042764 }, { 22.99976506, 0.06892168, 0.01189360 }, { 23.99968447, 0.08160907, 0.01348768 }, { 24.99958141, 0.09595706, 0.01521454 }, { 25.99945094, 0.11210070, 0.01707876 }, { 26.99928734, 0.13017951, 0.01908478 }, { 27.99908396, 0.15033741, 0.02123695 }, { 28.99883316, 0.17272255, 0.02353946 }, { 29.99852621, 0.19748720, 0.02599641 }, { 30.99815320, 0.22478761, 0.02861176 }, { 31.99770289, 0.25478386, 0.03138933 }, { 32.99716263, 0.28763976, 0.03433282 }, { 33.99651823, 0.32352263, 0.03744577 }, { 34.99575384, 0.36260323, 0.04073160 }, { 35.99485183, 0.40505554, 0.04419358 }, { 36.99379267, 0.45105663, 0.04783483 }, { 37.99255477, 0.50078647, 0.05165832 }, { 38.99111437, 0.55442778, 0.05566687 }, { 39.98944540, 0.61216585, 0.05986316 }, { 40.98751934, 0.67418837, 0.06424968 }, { 41.98530510, 0.74068519, 0.06882879 }, { 42.98276885, 0.81184822, 0.07360269 }, { 43.97987389, 0.88787113, 0.07857340 }, { 44.97658052, 0.96894926, 0.08374279 }, { 45.97284590, 1.05527932, 0.08911256 }, { 46.96862392, 1.14705924, 0.09468425 }, { 47.96386503, 1.24448792, 0.10045921 }, { 48.95851616, 1.34776502, 0.10643865 }, { 49.95252053, 1.45709078, 0.11262360 }, { 50.94581758, 1.57266570, 0.11901490 }, { 51.93834282, 1.69469039, 0.12561324 }, { 52.93002770, 1.82336530, 0.13241914 }, { 53.92079954, 1.95889046, 0.13943293 }, { 54.91058137, 2.10146526, 0.14665478 }, { 55.89929189, 2.25128821, 0.15408467 }, { 56.88684532, 2.40855664, 0.16172244 }, { 57.87315136, 2.57346648, 0.16956772 }, { 58.85811511, 2.74621201, 0.17761999 }, { 59.84163697, 2.92698553, 0.18587854 }, { 60.82361262, 3.11597720, 0.19434252 }, { 61.80393296, 3.31337465, 0.20301088 }, { 62.78248409, 3.51936283, 0.21188240 }, { 63.75914726, 3.73412363, 0.22095570 }, { 64.73379886, 3.95783569, 0.23022925 }, { 65.70631046, 4.19067408, 0.23970131 }, { 66.67654877, 4.43281005, 0.24937001 }, { 67.64437571, 4.68441075, 0.25923332 }, { 68.60964841, 4.94563895, 0.26928901 }, { 69.57221932, 5.21665279, 0.27953473 }, { 70.53193621, 5.49760550, 0.28996794 }, { 71.48864229, 5.78864514, 0.30058598 }, { 72.44217632, 6.08991434, 0.31138600 }, { 73.39237269, 6.40155004, 0.32236502 }, { 74.33906157, 6.72368325, 0.33351991 }, { 75.28206901, 7.05643881, 0.34484738 }, { 76.22121717, 7.39993513, 0.35634401 }, { 77.15632442, 7.75428397, 0.36800623 }, { 78.08720555, 8.11959024, 0.37983034 }, { 79.01367199, 8.49595174, 0.39181250 }, { 79.93553197, 8.88345902, 0.40394875 }, { 80.85259083, 9.28219512, 0.41623498 }, { 81.76465116, 9.69223544, 0.42866697 }, { 82.67151315, 10.11364754, 0.44124037 }, { 83.57297478, 10.54649100, 0.45395074 }, { 84.46883215, 10.99081727, 0.46679348 }, { 85.35887973, 11.44666954, 0.47976392 }, { 86.24291069, 11.91408260, 0.49285726 }, { 87.12071720, 12.39308280, 0.50606860 }, { 87.99209073, 12.88368791, 0.51939297 }, { 88.85682242, 13.38590705, 0.53282525 }, { 89.71470337, 13.89974070, 0.54636029 }, { 90.56552499, 14.42518058, 0.55999282 }, { 91.40907939, 14.96220971, 0.57371750 }, { 92.24515966, 15.51080235, 0.58752890 }, { 93.07356029, 16.07092405, 0.60142153 }, { 93.89407747, 16.64253169, 0.61538984 }, { 94.70650951, 17.22557350, 0.62942820 }, { 95.51065716, 17.81998918, 0.64353093 }, { 96.30632394, 18.42570995, 0.65769229 }, { 97.09331659, 19.04265868, 0.67190651 }, { 97.87144532, 19.67075002, 0.68616775 }, { 98.64052423, 20.30989052, 0.70047015 }, { 99.40037162, 20.95997883, 0.71480781 }, { 100.15081035, 21.62090585, 0.72917479 }, { 100.89166815, 22.29255492, 0.74356515 }, { 101.62277795, 22.97480206, 0.75797291 }, { 102.34397821, 23.66751618, 0.77239207 }, { 103.05511321, 24.37055934, 0.78681665 }, { 103.75603333, 25.08378696, 0.80124064 }, { 104.44659537, 25.80704816, 0.81565803 }, { 105.12666276, 26.54018597, 0.83006284 }, { 105.79610586, 27.28303770, 0.84444907 }, { 106.45480219, 28.03543517, 0.85881076 }, { 107.10263665, 28.79720509, 0.87314195 }, { 107.73950171, 29.56816933, 0.88743672 }, { 108.36529764, 30.34814531, 0.90168918 }, { 108.97993265, 31.13694629, 0.91589346 }, { 109.58332308, 31.93438174, 0.93004375 }, { 110.17539352, 32.74025770, 0.94413427 }, { 110.75607693, 33.55437709, 0.95815930 }, { 111.32531477, 34.37654013, 0.97211317 }, { 111.88305705, 35.20654465, 0.98599026 }, { 112.42926243, 36.04418647, 0.99978504 }, { 112.96389827, 36.88925976, 1.01349202 }, { 113.48694064, 37.74155739, 1.02710579 }, { 113.99837434, 38.60087127, 1.04062104 }, { 114.49819293, 39.46699273, 1.05403251 }, { 114.98639865, 40.33971287, 1.06733504 }, { 115.46300244, 41.21882284, 1.08052357 }, { 115.92802383, 42.10411424, 1.09359312 }, { 116.38149093, 42.99537943, 1.10653882 }, { 116.82344027, 43.89241181, 1.11935590 }, { 117.25391676, 44.79500617, 1.13203968 }, { 117.67297355, 45.70295898, 1.14458563 }, { 118.08067186, 46.61606864, 1.15698929 }, { 118.47708091, 47.53413583, 1.16924635 }, { 118.86227766, 48.45696368, 1.18135262 }, { 119.23634675, 49.38435810, 1.19330401 }, { 119.59938023, 50.31612798, 1.20509658 }, { 119.95147739, 51.25208542, 1.21672652 }, { 120.29274456, 52.19204593, 1.22819016 }, { 120.62329491, 53.13582866, 1.23948395 }, { 120.94324820, 54.08325654, 1.25060451 }, { 121.25273055, 55.03415648, 1.26154857 }, { 121.55187422, 55.98835951, 1.27231303 }, { 121.84081736, 56.94570090, 1.28289494 }, { 122.11970372, 57.90602032, 1.29329148 }, { 122.38868247, 58.86916192, 1.30350002 }, { 122.64790786, 59.83497445, 1.31351806 }, { 122.89753903, 60.80331129, 1.32334326 }, { 123.13773966, 61.77403058, 1.33297345 }, { 123.36867777, 62.74699521, 1.34240662 }, { 123.59052543, 63.72207290, 1.35164091 }, { 123.80345847, 64.69913622, 1.36067465 }, { 124.00765621, 65.67806256, 1.36950632 }, { 124.20330122, 66.65873418, 1.37813457 }, { 124.39057899, 67.64103817, 1.38655822 }, { 124.56967774, 68.62486641, 1.39477627 }, { 124.74078805, 69.61011558, 1.40278788 }, { 124.90410269, 70.59668704, 1.41059239 }, { 125.05981627, 71.58448686, 1.41818929 }, { 125.20812505, 72.57342566, 1.42557828 }, { 125.34922662, 73.56341862, 1.43275921 }, { 125.48331969, 74.55438531, 1.43973209 }, { 125.61060381, 75.54624969, 1.44649714 }, { 125.73127911, 76.53893992, 1.45305472 }, { 125.84554609, 77.53238831, 1.45940538 }, { 125.95360536, 78.52653118, 1.46554983 }, { 126.05565739, 79.52130876, 1.47148898 }, { 126.15190231, 80.51666507, 1.47722386 }, { 126.24253964, 81.51254776, 1.48275573 }, { 126.32776812, 82.50890800, 1.48808596 }, { 126.40778542, 83.50570038, 1.49321614 }, { 126.48278800, 84.50288270, 1.49814799 }, { 126.55297085, 85.50041591, 1.50288342 }, { 126.61852732, 86.49826391, 1.50742447 }, { 126.67964888, 87.49639345, 1.51177339 }, { 126.73652499, 88.49477397, 1.51593255 }, { 126.78934282, 89.49337748, 1.51990449 }, { 126.83828716, 90.49217839, 1.52369191 }, { 126.88354017, 91.49115340, 1.52729766 }, { 126.92528124, 92.49028138, 1.53072475 }, { 126.96368682, 93.48954317, 1.53397632 }, { 126.99893023, 94.48892153, 1.53705567 }, { 127.03118153, 95.48840097, 1.53996624 }, { 127.06060734, 96.48796762, 1.54271161 }, { 127.08737069, 97.48760914, 1.54529550 }, { 127.11163089, 98.48731458, 1.54772177 }, { 127.13354339, 99.48707425, 1.54999439 }, { 127.15325960, 100.48687968, 1.55211747 }, { 127.17092682, 101.48672344, 1.55409526 }, { 127.18668807, 102.48659909, 1.55593211 }, { 127.20068195, 103.48650105, 1.55763250 }, { 127.21304257, 104.48642455, 1.55920100 }, { 127.22389941, 105.48636552, 1.56064233 }, { 127.23337720, 106.48632054, 1.56196128 }, { 127.24159582, 107.48628670, 1.56316276 }, { 127.24867022, 108.48626163, 1.56425177 }, { 127.25471027, 109.48624335, 1.56523341 }, { 127.25982074, 110.48623026, 1.56611287 }, { 127.26410115, 111.48622107, 1.56689541 }, { 127.26764570, 112.48621477, 1.56758639 }, { 127.27054324, 113.48621056, 1.56819124 }, { 127.27287711, 114.48620782, 1.56871545 }, { 127.27472515, 115.48620611, 1.56916459 }, { 127.27615959, 116.48620507, 1.56954429 }, { 127.27724699, 117.48620448, 1.56986025 }, { 127.27804821, 118.48620415, 1.57011819 }, { 127.27861835, 119.48620399, 1.57032391 }, { 127.27900669, 120.48620391, 1.57048324 }, { 127.27925665, 121.48620388, 1.57060204 }, { 127.27940578, 122.48620387, 1.57068624 }, { 127.27948570, 123.48620386, 1.57074174 }, { 127.27952208, 124.48620386, 1.57077453 }, { 127.27953464, 125.48620386, 1.57079056 }, { 127.27922061, 127.27922061, 1.57079633 }, };
//		static const Position data_90[155] =
//				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000069, 0.00000275 }, { 2.00000000, 0.00001120, 0.00002229 }, { 3.00000000, 0.00005690, 0.00007559 }, { 3.99999999, 0.00018005, 0.00017952 }, { 4.99999996, 0.00043979, 0.00035089 }, { 5.99999984, 0.00091200, 0.00060639 }, { 6.99999953, 0.00168919, 0.00096257 }, { 7.99999882, 0.00288031, 0.00143582 }, { 8.99999730, 0.00461064, 0.00204232 }, { 9.99999437, 0.00702150, 0.00279804 }, { 10.99998906, 0.01027009, 0.00371871 }, { 11.99997994, 0.01452915, 0.00481976 }, { 12.99996498, 0.01998674, 0.00611635 }, { 13.99994136, 0.02684590, 0.00762328 }, { 14.99990529, 0.03532429, 0.00935503 }, { 15.99985178, 0.04565384, 0.01132570 }, { 16.99977436, 0.05808035, 0.01354897 }, { 17.99966483, 0.07286311, 0.01603813 }, { 18.99951292, 0.09027438, 0.01880601 }, { 19.99930597, 0.11059900, 0.02186497 }, { 20.99902851, 0.13413385, 0.02522692 }, { 21.99866194, 0.16118732, 0.02890322 }, { 22.99818401, 0.19207883, 0.03290473 }, { 23.99756846, 0.22713818, 0.03724178 }, { 24.99678447, 0.26670501, 0.04192411 }, { 25.99579622, 0.31112814, 0.04696092 }, { 26.99456233, 0.36076493, 0.05236079 }, { 27.99303539, 0.41598064, 0.05813172 }, { 28.99116136, 0.47714766, 0.06428108 }, { 29.98887904, 0.54464485, 0.07081561 }, { 30.98611953, 0.61885671, 0.07774141 }, { 31.98280566, 0.70017266, 0.08506393 }, { 32.97885144, 0.78898618, 0.09278795 }, { 33.97416148, 0.88569401, 0.10091761 }, { 34.96863052, 0.99069524, 0.10945634 }, { 35.96214284, 1.10439044, 0.11840691 }, { 36.95457179, 1.22718074, 0.12777141 }, { 37.94577934, 1.35946688, 0.13755121 }, { 38.93561559, 1.50164822, 0.14774703 }, { 39.92391839, 1.65412180, 0.15835886 }, { 40.91051296, 1.81728125, 0.16938602 }, { 41.89521160, 1.99151583, 0.18082714 }, { 42.87781335, 2.17720933, 0.19268015 }, { 43.85810387, 2.37473902, 0.20494230 }, { 44.83585518, 2.58447456, 0.21761015 }, { 45.81082564, 2.80677696, 0.23067960 }, { 46.78275991, 3.04199742, 0.24414587 }, { 47.75138896, 3.29047629, 0.25800352 }, { 48.71643024, 3.55254199, 0.27224648 }, { 49.67758783, 3.82850987, 0.28686800 }, { 50.63455274, 4.11868122, 0.30186074 }, { 51.58700330, 4.42334217, 0.31721670 }, { 52.53460551, 4.74276269, 0.33292732 }, { 53.47701367, 5.07719562, 0.34898341 }, { 54.41387090, 5.42687565, 0.36537524 }, { 55.34480991, 5.79201847, 0.38209249 }, { 56.26945369, 6.17281987, 0.39912432 }, { 57.18741642, 6.56945493, 0.41645936 }, { 58.09830439, 6.98207729, 0.43408573 }, { 59.00171699, 7.41081841, 0.45199108 }, { 59.89724779, 7.85578703, 0.47016257 }, { 60.78448569, 8.31706854, 0.48858694 }, { 61.66301609, 8.79472459, 0.50725050 }, { 62.53242219, 9.28879271, 0.52613916 }, { 63.39228625, 9.79928598, 0.54523847 }, { 64.24219100, 10.32619291, 0.56453360 }, { 65.08172091, 10.86947728, 0.58400943 }, { 65.91046372, 11.42907822, 0.60365051 }, { 66.72801178, 12.00491025, 0.62344113 }, { 67.53396351, 12.59686357, 0.64336533 }, { 68.32792484, 13.20480430, 0.66340692 }, { 69.10951063, 13.82857497, 0.68354952 }, { 69.87834609, 14.46799497, 0.70377658 }, { 70.63406816, 15.12286124, 0.72407142 }, { 71.37632686, 15.79294895, 0.74441723 }, { 72.10478659, 16.47801231, 0.76479713 }, { 72.81912743, 17.17778548, 0.78519416 }, { 73.51904630, 17.89198357, 0.80559137 }, { 74.20425810, 18.62030368, 0.82597177 }, { 74.87449682, 19.36242602, 0.84631843 }, { 75.52951645, 20.11801516, 0.86661445 }, { 76.16909196, 20.88672127, 0.88684304 }, { 76.79302005, 21.66818139, 0.90698749 }, { 77.40111990, 22.46202086, 0.92703126 }, { 77.99323379, 23.26785462, 0.94695797 }, { 78.56922763, 24.08528869, 0.96675142 }, { 79.12899134, 24.91392156, 0.98639564 }, { 79.67243922, 25.75334564, 1.00587493 }, { 80.19951014, 26.60314869, 1.02517383 }, { 80.71016765, 27.46291523, 1.04427720 }, { 81.20439999, 28.33222797, 1.06317022 }, { 81.68222002, 29.21066920, 1.08183842 }, { 82.14366501, 30.09782207, 1.10026771 }, { 82.58879637, 30.99327198, 1.11844438 }, { 83.01769927, 31.89660779, 1.13635518 }, { 83.43048220, 32.80742300, 1.15398725 }, { 83.82727642, 33.72531695, 1.17132824 }, { 84.20823532, 34.64989584, 1.18836624 }, { 84.57353379, 35.58077377, 1.20508990 }, { 84.92336741, 36.51757366, 1.22148834 }, { 85.25795168, 37.45992810, 1.23755124 }, { 85.57752111, 38.40748010, 1.25326886 }, { 85.88232834, 39.35988384, 1.26863200 }, { 86.17264320, 40.31680523, 1.28363208 }, { 86.44875165, 41.27792244, 1.29826110 }, { 86.71095482, 42.24292637, 1.31251170 }, { 86.95956796, 43.21152096, 1.32637712 }, { 87.19491934, 44.18342353, 1.33985128 }, { 87.41734919, 45.15836492, 1.35292871 }, { 87.62720864, 46.13608964, 1.36560464 }, { 87.82485856, 47.11635591, 1.37787493 }, { 88.01066857, 48.09893564, 1.38973615 }, { 88.18501585, 49.08361433, 1.40118553 }, { 88.34828414, 50.07019089, 1.41222099 }, { 88.50086263, 51.05847749, 1.42284114 }, { 88.64314494, 52.04829923, 1.43304528 }, { 88.77552805, 53.03949383, 1.44283340 }, { 88.89841133, 54.03191127, 1.45220618 }, { 89.01219549, 55.02541340, 1.46116502 }, { 89.11728168, 56.01987346, 1.46971196 }, { 89.21407046, 57.01517564, 1.47784977 }, { 89.30296096, 58.01121454, 1.48558187 }, { 89.38434993, 59.00789471, 1.49291237 }, { 89.45863090, 60.00513005, 1.49984605 }, { 89.52619332, 61.00284332, 1.50638835 }, { 89.58742176, 62.00096552, 1.51254535 }, { 89.64269512, 62.99943538, 1.51832378 }, { 89.69238589, 63.99819881, 1.52373100 }, { 89.73685937, 64.99720832, 1.52877498 }, { 89.77647302, 65.99642247, 1.53346432 }, { 89.81157575, 66.99580540, 1.53780818 }, { 89.84250728, 67.99532623, 1.54181630 }, { 89.86959754, 68.99495866, 1.54549900 }, { 89.89316603, 69.99468041, 1.54886712 }, { 89.91352126, 70.99447283, 1.55193203 }, { 89.93096024, 71.99432044, 1.55470562 }, { 89.94576791, 72.99421054, 1.55720022 }, { 89.95821668, 73.99413285, 1.55942869 }, { 89.96856596, 74.99407913, 1.56140427 }, { 89.97706168, 75.99404292, 1.56314066 }, { 89.98393593, 76.99401919, 1.56465195 }, { 89.98940652, 77.99400416, 1.56595260 }, { 89.99367661, 78.99399499, 1.56705741 }, { 89.99693442, 79.99398965, 1.56798154 }, { 89.99935285, 80.99398670, 1.56874041 }, { 90.00108926, 81.99398518, 1.56934974 }, { 90.00228513, 82.99398445, 1.56982550 }, { 90.00306589, 83.99398414, 1.57018386 }, { 90.00354066, 84.99398403, 1.57044121 }, { 90.00380213, 85.99398399, 1.57061410 }, { 90.00392632, 86.99398398, 1.57071921 }, { 90.00397255, 87.99398398, 1.57077335 }, { 90.00398326, 88.99398398, 1.57079341 }, { 90.00000000, 90.00000000, 1.57079633 }, };
//		static const Position data_135[219] =
//				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000036, 0.00000144 }, { 2.00000000, 0.00000586, 0.00001166 }, { 3.00000000, 0.00002976, 0.00003954 }, { 4.00000000, 0.00009419, 0.00009394 }, { 4.99999999, 0.00023014, 0.00018368 }, { 5.99999996, 0.00047739, 0.00031757 }, { 6.99999987, 0.00088453, 0.00050438 }, { 7.99999967, 0.00150888, 0.00075284 }, { 8.99999926, 0.00241648, 0.00107161 }, { 9.99999845, 0.00368199, 0.00146931 }, { 10.99999699, 0.00538868, 0.00195450 }, { 11.99999446, 0.00762830, 0.00253564 }, { 12.99999032, 0.01050108, 0.00322114 }, { 13.99998376, 0.01411556, 0.00401932 }, { 14.99997372, 0.01858858, 0.00493839 }, { 15.99995879, 0.02404514, 0.00598647 }, { 16.99993712, 0.03061830, 0.00717158 }, { 17.99990639, 0.03844906, 0.00850162 }, { 18.99986363, 0.04768629, 0.00998436 }, { 19.99980520, 0.05848653, 0.01162747 }, { 20.99972659, 0.07101393, 0.01343847 }, { 21.99962236, 0.08544006, 0.01542475 }, { 22.99948597, 0.10194379, 0.01759354 }, { 23.99930962, 0.12071112, 0.01995193 }, { 24.99908409, 0.14193503, 0.02250686 }, { 25.99879860, 0.16581531, 0.02526510 }, { 26.99844057, 0.19255837, 0.02823326 }, { 27.99799547, 0.22237708, 0.03141776 }, { 28.99744659, 0.25549055, 0.03482486 }, { 29.99677481, 0.29212396, 0.03846063 }, { 30.99595840, 0.33250830, 0.04233094 }, { 31.99497278, 0.37688021, 0.04644149 }, { 32.99379024, 0.42548172, 0.05079776 }, { 33.99237970, 0.47856002, 0.05540504 }, { 34.99070648, 0.53636721, 0.06026841 }, { 35.98873197, 0.59916006, 0.06539274 }, { 36.98641337, 0.66719971, 0.07078268 }, { 37.98370344, 0.74075142, 0.07644266 }, { 38.98055014, 0.82008429, 0.08237691 }, { 39.97689642, 0.90547092, 0.08858939 }, { 40.97267984, 0.99718715, 0.09508388 }, { 41.96783232, 1.09551169, 0.10186389 }, { 42.96227981, 1.20072582, 0.10893270 }, { 43.95594203, 1.31311302, 0.11629338 }, { 44.94873211, 1.43295864, 0.12394873 }, { 45.94055634, 1.56054947, 0.13190132 }, { 46.93131386, 1.69617342, 0.14015346 }, { 47.92089638, 1.84011909, 0.14870723 }, { 48.90918786, 1.99267533, 0.15756447 }, { 49.89606430, 2.15413086, 0.16672673 }, { 50.88139344, 2.32477382, 0.17619535 }, { 51.86503450, 2.50489130, 0.18597141 }, { 52.84683795, 2.69476887, 0.19605571 }, { 53.82664533, 2.89469013, 0.20644882 }, { 54.80428894, 3.10493620, 0.21715104 }, { 55.77959177, 3.32578522, 0.22816245 }, { 56.75236723, 3.55751184, 0.23948282 }, { 57.72241906, 3.80038667, 0.25111172 }, { 58.68954116, 4.05467578, 0.26304842 }, { 59.65351755, 4.32064014, 0.27529197 }, { 60.61412220, 4.59853504, 0.28784115 }, { 61.57111906, 4.88860957, 0.30069448 }, { 62.52426200, 5.19110604, 0.31385026 }, { 63.47329482, 5.50625937, 0.32730651 }, { 64.41795128, 5.83429656, 0.34106102 }, { 65.35795520, 6.17543610, 0.35511131 }, { 66.29302051, 6.52988738, 0.36945470 }, { 67.22285147, 6.89785008, 0.38408823 }, { 68.14714274, 7.27951367, 0.39900870 }, { 69.06557966, 7.67505677, 0.41421271 }, { 69.97783849, 8.08464662, 0.42969659 }, { 70.88358666, 8.50843850, 0.44545645 }, { 71.78248310, 8.94657520, 0.46148818 }, { 72.67417861, 9.39918649, 0.47778744 }, { 73.55831624, 9.86638858, 0.49434966 }, { 74.43453172, 10.34828365, 0.51117008 }, { 75.30245393, 10.84495933, 0.52824370 }, { 76.16170542, 11.35648829, 0.54556531 }, { 77.01190291, 11.88292776, 0.56312953 }, { 77.85265790, 12.42431915, 0.58093074 }, { 78.68357726, 12.98068767, 0.59896315 }, { 79.50426387, 13.55204195, 0.61722076 }, { 80.31431728, 14.13837379, 0.63569740 }, { 81.11333443, 14.73965781, 0.65438673 }, { 81.90091037, 15.35585128, 0.67328219 }, { 82.67663899, 15.98689384, 0.69237710 }, { 83.44011382, 16.63270743, 0.71166459 }, { 84.19092878, 17.29319611, 0.73113763 }, { 84.92867906, 17.96824599, 0.75078906 }, { 85.65296187, 18.65772527, 0.77061153 }, { 86.36337732, 19.36148417, 0.79059759 }, { 87.05952928, 20.07935509, 0.81073964 }, { 87.74102617, 20.81115265, 0.83102995 }, { 88.40748190, 21.55667393, 0.85146067 }, { 89.05851664, 22.31569865, 0.87202383 }, { 89.69375774, 23.08798946, 0.89271135 }, { 90.31284052, 23.87329223, 0.91351506 }, { 90.91540915, 24.67133647, 0.93442669 }, { 91.50111744, 25.48183570, 0.95543786 }, { 92.06962964, 26.30448798, 0.97654014 }, { 92.62062124, 27.13897637, 0.99772500 }, { 93.15377971, 27.98496950, 1.01898386 }, { 93.66880525, 28.84212223, 1.04030806 }, { 94.16541148, 29.71007624, 1.06168890 }, { 94.64332611, 30.58846075, 1.08311764 }, { 95.10229155, 31.47689326, 1.10458548 }, { 95.54206556, 32.37498028, 1.12608360 }, { 95.96242174, 33.28231820, 1.14760315 }, { 96.36315010, 34.19849403, 1.16913527 }, { 96.74405746, 35.12308634, 1.19067109 }, { 97.10496794, 36.05566609, 1.21220172 }, { 97.44572328, 36.99579758, 1.23371830 }, { 97.76618317, 37.94303935, 1.25521196 }, { 98.06622553, 38.89694511, 1.27667385 }, { 98.34574673, 39.85706472, 1.29809517 }, { 98.60466175, 40.82294513, 1.31946712 }, { 98.84290427, 41.79413133, 1.34078097 }, { 99.06042678, 42.77016737, 1.36202802 }, { 99.25720054, 43.75059724, 1.38319963 }, { 99.43321557, 44.73496590, 1.40428722 }, { 99.58848052, 45.72282018, 1.42528228 }, { 99.72302257, 46.71370971, 1.44617639 }, { 99.83688717, 47.70718787, 1.46696119 }, { 99.93013788, 48.70281266, 1.48762842 }, { 100.00285599, 49.70014757, 1.50816993 }, { 100.05514025, 50.69876243, 1.52857765 }, { 100.08710648, 51.69823426, 1.54884364 }, { 100.09888712, 52.69814801, 1.56896006 }, { 100.09063082, 53.69809733, 1.58891921 }, { 100.06250194, 54.69768531, 1.60871351 }, { 100.01467999, 55.69652512, 1.62833552 }, { 99.94735912, 56.69424072, 1.64777794 }, { 99.86074753, 57.69046737, 1.66703362 }, { 99.75506685, 58.68485226, 1.68609555 }, { 99.63055151, 59.67705501, 1.70495691 }, { 99.48744815, 60.66674811, 1.72361101 }, { 99.32601486, 61.65361739, 1.74205136 }, { 99.14652059, 62.63736235, 1.76027163 }, { 98.94924445, 63.61769655, 1.77826567 }, { 98.73447499, 64.59434787, 1.79602753 }, { 98.50250951, 65.56705873, 1.81355144 }, { 98.25365339, 66.53558636, 1.83083184 }, { 97.98821938, 67.49970285, 1.84786334 }, { 97.70652690, 68.45919537, 1.86464080 }, { 97.40890134, 69.41386615, 1.88115925 }, { 97.09567344, 70.36353255, 1.89741395 }, { 96.76717854, 71.30802702, 1.91340038 }, { 96.42375599, 72.24719707, 1.92911423 }, { 96.06574847, 73.18090514, 1.94455143 }, { 95.69350138, 74.10902850, 1.95970814 }, { 95.30736224, 75.03145906, 1.97458072 }, { 94.90768007, 75.94810318, 1.98916580 }, { 94.49480487, 76.85888144, 2.00346023 }, { 94.06908701, 77.76372838, 2.01746110 }, { 93.63087677, 78.66259218, 2.03116574 }, { 93.18052378, 79.55543439, 2.04457175 }, { 92.71837658, 80.44222955, 2.05767693 }, { 92.24478214, 81.32296484, 2.07047936 }, { 91.76008546, 82.19763971, 2.08297738 }, { 91.26462913, 83.06626543, 2.09516954 }, { 90.75875297, 83.92886472, 2.10705468 }, { 90.24279366, 84.78547129, 2.11863187 }, { 89.71708442, 85.63612940, 2.12990045 }, { 89.18195470, 86.48089338, 2.14086001 }, { 88.63772990, 87.31982718, 2.15151038 }, { 88.08473109, 88.15300387, 2.16185167 }, { 87.52327477, 88.98050518, 2.17188422 }, { 86.95367269, 89.80242099, 2.18160865 }, { 86.37623161, 90.61884883, 2.19102581 }, { 85.79125315, 91.42989339, 2.20013681 }, { 85.19903362, 92.23566604, 2.20894303 }, { 84.59986388, 93.03628431, 2.21744608 }, { 83.99402925, 93.83187138, 2.22564783 }, { 83.38180934, 94.62255563, 2.23355039 }, { 82.76347802, 95.40847010, 2.24115614 }, { 82.13930332, 96.18975206, 2.24846766 }, { 81.50954736, 96.96654246, 2.25548782 }, { 80.87446632, 97.73898553, 2.26221970 }, { 80.23431038, 98.50722827, 2.26866664 }, { 79.58932368, 99.27142000, 2.27483219 }, { 78.93974435, 100.03171192, 2.28072015 }, { 78.28580441, 100.78825665, 2.28633454 }, { 77.62772986, 101.54120785, 2.29167962 }, { 76.96574060, 102.29071973, 2.29675985 }, { 76.30005046, 103.03694671, 2.30157992 }, { 75.63086722, 103.78004298, 2.30614475 }, { 74.95839261, 104.52016212, 2.31045943 }, { 74.28282231, 105.25745677, 2.31452930 }, { 73.60434599, 105.99207821, 2.31835987 }, { 72.92314728, 106.72417605, 2.32195687 }, { 72.23940385, 107.45389789, 2.32532620 }, { 71.55328735, 108.18138901, 2.32847398 }, { 70.86496348, 108.90679202, 2.33140647 }, { 70.17459198, 109.63024663, 2.33413015 }, { 69.48232664, 110.35188932, 2.33665164 }, { 68.78831531, 111.07185309, 2.33897775 }, { 68.09269990, 111.79026719, 2.34111542 }, { 67.39561640, 112.50725692, 2.34307179 }, { 66.69719485, 113.22294336, 2.34485411 }, { 65.99755939, 113.93744318, 2.34646980 }, { 65.29682818, 114.65086844, 2.34792640 }, { 64.59511346, 115.36332638, 2.34923158 }, { 63.89252152, 116.07491927, 2.35039315 }, { 63.18915266, 116.78574425, 2.35141903 }, { 62.48510119, 117.49589316, 2.35231726 }, { 61.78045545, 118.20545240, 2.35309596 }, { 61.07529771, 118.91450284, 2.35376338 }, { 60.36970423, 119.62311967, 2.35432784 }, { 59.66374518, 120.33137232, 2.35479776 }, { 58.95748466, 121.03932434, 2.35518162 }, { 58.25098062, 121.74703335, 2.35548800 }, { 57.54428492, 122.45455096, 2.35572550 }, { 56.83744320, 123.16192271, 2.35590283 }, { 56.13049495, 123.86918798, 2.35602871 }, { 55.42347344, 124.57638002, 2.35611190 }, { 54.71640570, 125.28352585, 2.35616123 }, { 54.00931255, 125.99064625, 2.35618554 }, { 52.72238106, 127.27758345, 2.35619449 }, };
//		static const Position data_180[464] =
//				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000005, 0.00000020 }, { 2.00000000, 0.00000082, 0.00000164 }, { 3.00000000, 0.00000418, 0.00000556 }, { 4.00000000, 0.00001325, 0.00001321 }, { 5.00000000, 0.00003237, 0.00002585 }, { 6.00000000, 0.00006717, 0.00004470 }, { 7.00000000, 0.00012450, 0.00007103 }, { 7.99999999, 0.00021244, 0.00010607 }, { 8.99999999, 0.00034035, 0.00015106 }, { 9.99999997, 0.00051880, 0.00020725 }, { 10.99999994, 0.00075961, 0.00027587 }, { 11.99999989, 0.00107585, 0.00035816 }, { 12.99999981, 0.00148179, 0.00045535 }, { 13.99999968, 0.00199298, 0.00056867 }, { 14.99999947, 0.00262615, 0.00069936 }, { 15.99999917, 0.00339929, 0.00084863 }, { 16.99999874, 0.00433160, 0.00101770 }, { 17.99999812, 0.00544349, 0.00120779 }, { 18.99999726, 0.00675661, 0.00142012 }, { 19.99999607, 0.00829380, 0.00165590 }, { 20.99999448, 0.01007911, 0.00191633 }, { 21.99999235, 0.01213779, 0.00220260 }, { 22.99998957, 0.01449632, 0.00251592 }, { 23.99998595, 0.01718232, 0.00285748 }, { 24.99998132, 0.02022464, 0.00322846 }, { 25.99997544, 0.02365330, 0.00363004 }, { 26.99996803, 0.02749948, 0.00406340 }, { 27.99995880, 0.03179556, 0.00452971 }, { 28.99994736, 0.03657507, 0.00503012 }, { 29.99993332, 0.04187269, 0.00556579 }, { 30.99991618, 0.04772427, 0.00613788 }, { 31.99989542, 0.05416681, 0.00674753 }, { 32.99987039, 0.06123842, 0.00739587 }, { 33.99984042, 0.06897837, 0.00808403 }, { 34.99980471, 0.07742704, 0.00881314 }, { 35.99976237, 0.08662594, 0.00958430 }, { 36.99971243, 0.09661767, 0.01039863 }, { 37.99965377, 0.10744594, 0.01125722 }, { 38.99958517, 0.11915556, 0.01216116 }, { 39.99950529, 0.13179241, 0.01311154 }, { 40.99941261, 0.14540347, 0.01410943 }, { 41.99930549, 0.16003674, 0.01515589 }, { 42.99918212, 0.17574134, 0.01625198 }, { 43.99904050, 0.19256737, 0.01739875 }, { 44.99887845, 0.21056603, 0.01859723 }, { 45.99869359, 0.22978950, 0.01984845 }, { 46.99848335, 0.25029099, 0.02115342 }, { 47.99824488, 0.27212475, 0.02251317 }, { 48.99797515, 0.29534597, 0.02392868 }, { 49.99767084, 0.32001087, 0.02540094 }, { 50.99732836, 0.34617662, 0.02693094 }, { 51.99694385, 0.37390136, 0.02851963 }, { 52.99651314, 0.40324418, 0.03016797 }, { 53.99603175, 0.43426510, 0.03187692 }, { 54.99549487, 0.46702507, 0.03364739 }, { 55.99489732, 0.50158595, 0.03548032 }, { 56.99423358, 0.53801052, 0.03737661 }, { 57.99349772, 0.57636241, 0.03933717 }, { 58.99268340, 0.61670614, 0.04136288 }, { 59.99178390, 0.65910709, 0.04345462 }, { 60.99079200, 0.70363148, 0.04561326 }, { 61.98970006, 0.75034636, 0.04783963 }, { 62.98849993, 0.79931959, 0.05013458 }, { 63.98718297, 0.85061982, 0.05249895 }, { 64.98574002, 0.90431649, 0.05493353 }, { 65.98416135, 0.96047981, 0.05743913 }, { 66.98243669, 1.01918074, 0.06001654 }, { 67.98055515, 1.08049095, 0.06266653 }, { 68.97850526, 1.14448285, 0.06538987 }, { 69.97627489, 1.21122954, 0.06818729 }, { 70.97385125, 1.28080477, 0.07105954 }, { 71.97122088, 1.35328299, 0.07400733 }, { 72.96836961, 1.42873926, 0.07703137 }, { 73.96528254, 1.50724927, 0.08013235 }, { 74.96194399, 1.58888932, 0.08331095 }, { 75.95833755, 1.67373627, 0.08656783 }, { 76.95444595, 1.76186755, 0.08990364 }, { 77.95025113, 1.85336111, 0.09331901 }, { 78.94573415, 1.94829544, 0.09681457 }, { 79.94087522, 2.04674951, 0.10039092 }, { 80.93565359, 2.14880274, 0.10404865 }, { 81.93004764, 2.25453501, 0.10778833 }, { 82.92403475, 2.36402663, 0.11161053 }, { 83.91759132, 2.47735828, 0.11551579 }, { 84.91069276, 2.59461104, 0.11950464 }, { 85.90331342, 2.71586629, 0.12357760 }, { 86.89542661, 2.84120577, 0.12773515 }, { 87.88700453, 2.97071148, 0.13197779 }, { 88.87801828, 3.10446570, 0.13630599 }, { 89.86843781, 3.24255094, 0.14072019 }, { 90.85823191, 3.38504989, 0.14522083 }, { 91.84736817, 3.53204544, 0.14980834 }, { 92.83581298, 3.68362062, 0.15448311 }, { 93.82353147, 3.83985856, 0.15924553 }, { 94.81048751, 4.00084248, 0.16409598 }, { 95.79664366, 4.16665565, 0.16903481 }, { 96.78196119, 4.33738135, 0.17406236 }, { 97.76640000, 4.51310284, 0.17917895 }, { 98.74991865, 4.69390333, 0.18438490 }, { 99.73247428, 4.87986593, 0.18968048 }, { 100.71402265, 5.07107365, 0.19506598 }, { 101.69451805, 5.26760931, 0.20054165 }, { 102.67391333, 5.46955557, 0.20610773 }, { 103.65215988, 5.67699481, 0.21176445 }, { 104.62920754, 5.89000916, 0.21751201 }, { 105.60500466, 6.10868044, 0.22335061 }, { 106.57949805, 6.33309011, 0.22928041 }, { 107.55263295, 6.56331923, 0.23530158 }, { 108.52435302, 6.79944844, 0.24141425 }, { 109.49460031, 7.04155787, 0.24761855 }, { 110.46331528, 7.28972718, 0.25391459 }, { 111.43043674, 7.54403541, 0.26030245 }, { 112.39590186, 7.80456104, 0.26678221 }, { 113.35964615, 8.07138188, 0.27335392 }, { 114.32160342, 8.34457503, 0.28001762 }, { 115.28170583, 8.62421686, 0.28677334 }, { 116.23988382, 8.91038295, 0.29362108 }, { 117.19606612, 9.20314805, 0.30056082 }, { 118.15017973, 9.50258601, 0.30759254 }, { 119.10214995, 9.80876976, 0.31471620 }, { 120.05190030, 10.12177124, 0.32193172 }, { 120.99935260, 10.44166136, 0.32923904 }, { 121.94442689, 10.76850997, 0.33663804 }, { 122.88704149, 11.10238577, 0.34412863 }, { 123.82711293, 11.44335628, 0.35171067 }, { 124.76455602, 11.79148780, 0.35938402 }, { 125.69928379, 12.14684533, 0.36714850 }, { 126.63120752, 12.50949255, 0.37500394 }, { 127.56023676, 12.87949176, 0.38295014 }, { 128.48627929, 13.25690381, 0.39098689 }, { 129.40924116, 13.64178804, 0.39911396 }, { 130.32902670, 14.03420229, 0.40733109 }, { 131.24553849, 14.43420278, 0.41563803 }, { 132.15867742, 14.84184406, 0.42403450 }, { 133.06834268, 15.25717901, 0.43252019 }, { 133.97443175, 15.68025874, 0.44109480 }, { 134.87684048, 16.11113255, 0.44975800 }, { 135.77546303, 16.54984787, 0.45850943 }, { 136.67019193, 16.99645023, 0.46734874 }, { 137.56091813, 17.45098319, 0.47627555 }, { 138.44753094, 17.91348828, 0.48528946 }, { 139.32991813, 18.38400494, 0.49439006 }, { 140.20796594, 18.86257053, 0.50357693 }, { 141.08155907, 19.34922017, 0.51284963 }, { 141.95058074, 19.84398681, 0.52220769 }, { 142.81491274, 20.34690109, 0.53165065 }, { 143.67443542, 20.85799130, 0.54117800 }, { 144.52902774, 21.37728338, 0.55078926 }, { 145.37856733, 21.90480083, 0.56048389 }, { 146.22293049, 22.44056466, 0.57026136 }, { 147.06199227, 22.98459336, 0.58012113 }, { 147.89562648, 23.53690284, 0.59006261 }, { 148.72370576, 24.09750639, 0.60008524 }, { 149.54610159, 24.66641463, 0.61018842 }, { 150.36268439, 25.24363548, 0.62037153 }, { 151.17332350, 25.82917407, 0.63063395 }, { 151.97788731, 26.42303278, 0.64097505 }, { 152.77624326, 27.02521111, 0.65139415 }, { 153.56825789, 27.63570570, 0.66189060 }, { 154.35379693, 28.25451026, 0.67246372 }, { 155.13272536, 28.88161557, 0.68311280 }, { 155.90490741, 29.51700937, 0.69383713 }, { 156.67020671, 30.16067643, 0.70463599 }, { 157.42848626, 30.81259841, 0.71550864 }, { 158.17960857, 31.47275391, 0.72645432 }, { 158.92343570, 32.14111840, 0.73747227 }, { 159.65982930, 32.81766420, 0.74856172 }, { 160.38865072, 33.50236045, 0.75972186 }, { 161.10976105, 34.19517311, 0.77095190 }, { 161.82302123, 34.89606489, 0.78225101 }, { 162.52829206, 35.60499526, 0.79361836 }, { 163.22543435, 36.32192046, 0.80505311 }, { 163.91430892, 37.04679342, 0.81655441 }, { 164.59477673, 37.77956378, 0.82812138 }, { 165.26669895, 38.52017789, 0.83975314 }, { 165.92993702, 39.26857877, 0.85144881 }, { 166.58435272, 40.02470611, 0.86320747 }, { 167.22980829, 40.78849631, 0.87502822 }, { 167.86616649, 41.55988238, 0.88691012 }, { 168.49329066, 42.33879405, 0.89885224 }, { 169.11104485, 43.12515768, 0.91085363 }, { 169.71929385, 43.91889633, 0.92291332 }, { 170.31790332, 44.71992971, 0.93503035 }, { 170.90673983, 45.52817423, 0.94720373 }, { 171.48567099, 46.34354301, 0.95943248 }, { 172.05456549, 47.16594588, 0.97171559 }, { 172.61329323, 47.99528937, 0.98405204 }, { 173.16172536, 48.83147680, 0.99644082 }, { 173.69973439, 49.67440822, 1.00888089 }, { 174.22719427, 50.52398051, 1.02137122 }, { 174.74398047, 51.38008735, 1.03391075 }, { 175.24997008, 52.24261927, 1.04649842 }, { 175.74504186, 53.11146370, 1.05913317 }, { 176.22907635, 53.98650496, 1.07181392 }, { 176.70195597, 54.86762434, 1.08453958 }, { 177.16356504, 55.75470014, 1.09730905 }, { 177.61378993, 56.64760768, 1.11012125 }, { 178.05251909, 57.54621937, 1.12297505 }, { 178.47964316, 58.45040473, 1.13586934 }, { 178.89505502, 59.36003051, 1.14880300 }, { 179.29864991, 60.27496064, 1.16177489 }, { 179.69032546, 61.19505637, 1.17478388 }, { 180.06998180, 62.12017630, 1.18782882 }, { 180.43752160, 63.05017643, 1.20090855 }, { 180.79285017, 63.98491023, 1.21402192 }, { 181.13587552, 64.92422871, 1.22716776 }, { 181.46650844, 65.86798048, 1.24034491 }, { 181.78466253, 66.81601183, 1.25355218 }, { 182.09025431, 67.76816679, 1.26678839 }, { 182.38320326, 68.72428721, 1.28005236 }, { 182.66343188, 69.68421283, 1.29334289 }, { 182.93086575, 70.64778138, 1.30665879 }, { 183.18543362, 71.61482862, 1.31999884 }, { 183.42706740, 72.58518847, 1.33336186 }, { 183.65570227, 73.55869305, 1.34674662 }, { 183.87127669, 74.53517280, 1.36015190 }, { 184.07373249, 75.51445653, 1.37357650 }, { 184.26301488, 76.49637156, 1.38701919 }, { 184.43907250, 77.48074376, 1.40047874 }, { 184.60185747, 78.46739766, 1.41395393 }, { 184.75132542, 79.45615656, 1.42744352 }, { 184.88743554, 80.44684261, 1.44094627 }, { 185.01015058, 81.43927689, 1.45446096 }, { 185.11943691, 82.43327953, 1.46798634 }, { 185.21526453, 83.42866981, 1.48152118 }, { 185.29760711, 84.42526622, 1.49506422 }, { 185.36644199, 85.42288662, 1.50861423 }, { 185.42175021, 86.42134828, 1.52216996 }, { 185.46351652, 87.42046802, 1.53573016 }, { 185.49172941, 88.42006229, 1.54929359 }, { 185.50638110, 89.41994728, 1.56285900 }, { 185.50746753, 90.41993903, 1.57642513 }, { 185.49498841, 91.41985349, 1.58999075 }, { 185.46894718, 92.41950669, 1.60355461 }, { 185.42935103, 93.41871479, 1.61711545 }, { 185.37621088, 94.41729419, 1.63067203 }, { 185.30954138, 95.41506163, 1.64422310 }, { 185.22936089, 96.41183433, 1.65776741 }, { 185.13569148, 97.40743002, 1.67130373 }, { 185.02855890, 98.40166709, 1.68483081 }, { 184.90799256, 99.39436470, 1.69834740 }, { 184.77402551, 100.38534282, 1.71185228 }, { 184.62669442, 101.37442238, 1.72534420 }, { 184.46603954, 102.36142535, 1.73882192 }, { 184.29210466, 103.34617484, 1.75228422 }, { 184.10493711, 104.32849518, 1.76572986 }, { 183.90458769, 105.30821202, 1.77915762 }, { 183.69111064, 106.28515243, 1.79256628 }, { 183.46456361, 107.25914499, 1.80595462 }, { 183.22500758, 108.23001987, 1.81932142 }, { 182.97250686, 109.19760891, 1.83266547 }, { 182.70712901, 110.16174573, 1.84598556 }, { 182.42894479, 111.12226580, 1.85928049 }, { 182.13802812, 112.07900653, 1.87254907 }, { 181.83445600, 113.03180733, 1.88579009 }, { 181.51830846, 113.98050970, 1.89900237 }, { 181.18966854, 114.92495733, 1.91218472 }, { 180.84862214, 115.86499613, 1.92533597 }, { 180.49525805, 116.80047434, 1.93845495 }, { 180.12966782, 117.73124257, 1.95154049 }, { 179.75194570, 118.65715392, 1.96459143 }, { 179.36218861, 119.57806395, 1.97760662 }, { 178.96049601, 120.49383085, 1.99058490 }, { 178.54696988, 121.40431544, 2.00352515 }, { 178.12171460, 122.30938123, 2.01642622 }, { 177.68483693, 123.20889450, 2.02928699 }, { 177.23644586, 124.10272432, 2.04210634 }, { 176.77665259, 124.99074265, 2.05488317 }, { 176.30557044, 125.87282434, 2.06761636 }, { 175.82331475, 126.74884719, 2.08030483 }, { 175.33000282, 127.61869201, 2.09294748 }, { 174.82575381, 128.48224265, 2.10554324 }, { 174.31068866, 129.33938604, 2.11809103 }, { 173.78493005, 130.19001219, 2.13058981 }, { 173.24860223, 131.03401430, 2.14303851 }, { 172.70183102, 131.87128872, 2.15543609 }, { 172.14474369, 132.70173499, 2.16778152 }, { 171.57746887, 133.52525590, 2.18007378 }, { 171.00013648, 134.34175747, 2.19231184 }, { 170.41287762, 135.15114902, 2.20449472 }, { 169.81582454, 135.95334311, 2.21662141 }, { 169.20911048, 136.74825563, 2.22869093 }, { 168.59286966, 137.53580577, 2.24070230 }, { 167.96723714, 138.31591606, 2.25265457 }, { 167.33234878, 139.08851232, 2.26454679 }, { 166.68834111, 139.85352373, 2.27637801 }, { 166.03535129, 140.61088279, 2.28814730 }, { 165.37351701, 141.36052536, 2.29985376 }, { 164.70297642, 142.10239058, 2.31149646 }, { 164.02386801, 142.83642097, 2.32307452 }, { 163.33633060, 143.56256232, 2.33458705 }, { 162.64050319, 144.28076376, 2.34603319 }, { 161.93652494, 144.99097769, 2.35741207 }, { 161.22453505, 145.69315981, 2.36872285 }, { 160.50467271, 146.38726909, 2.37996470 }, { 159.77707702, 147.07326771, 2.39113679 }, { 159.04188692, 147.75112112, 2.40223832 }, { 158.29924111, 148.42079795, 2.41326850 }, { 157.54927797, 149.08227001, 2.42422653 }, { 156.79213553, 149.73551227, 2.43511166 }, { 156.02795135, 150.38050283, 2.44592313 }, { 155.25686252, 151.01722286, 2.45666020 }, { 154.47900551, 151.64565662, 2.46732213 }, { 153.69451618, 152.26579141, 2.47790822 }, { 152.90352968, 152.87761750, 2.48841777 }, { 152.10618043, 153.48112814, 2.49885008 }, { 151.30260199, 154.07631951, 2.50920450 }, { 150.49292707, 154.66319064, 2.51948035 }, { 149.67728746, 155.24174346, 2.52967701 }, { 148.85581395, 155.81198267, 2.53979383 }, { 148.02863632, 156.37391573, 2.54983021 }, { 147.19588324, 156.92755284, 2.55978555 }, { 146.35768227, 157.47290686, 2.56965926 }, { 145.51415979, 158.00999330, 2.57945077 }, { 144.66544095, 158.53883021, 2.58915954 }, { 143.81164966, 159.05943823, 2.59878502 }, { 142.95290850, 159.57184045, 2.60832669 }, { 142.08933872, 160.07606242, 2.61778404 }, { 141.22106020, 160.57213206, 2.62715658 }, { 140.34819139, 161.06007964, 2.63644384 }, { 139.47084929, 161.53993774, 2.64564535 }, { 138.58914944, 162.01174114, 2.65476066 }, { 137.70320585, 162.47552683, 2.66378935 }, { 136.81313101, 162.93133394, 2.67273101 }, { 135.91903584, 163.37920367, 2.68158524 }, { 135.02102966, 163.81917924, 2.69035165 }, { 134.11922021, 164.25130588, 2.69902989 }, { 133.21371356, 164.67563071, 2.70761959 }, { 132.30461416, 165.09220275, 2.71612044 }, { 131.39202478, 165.50107281, 2.72453211 }, { 130.47604651, 165.90229348, 2.73285431 }, { 129.55677873, 166.29591908, 2.74108674 }, { 128.63431913, 166.68200554, 2.74922916 }, { 127.70876366, 167.06061045, 2.75728129 }, { 126.78020656, 167.43179291, 2.76524292 }, { 125.84874030, 167.79561355, 2.77311382 }, { 124.91445564, 168.15213442, 2.78089379 }, { 123.97744157, 168.50141898, 2.78858266 }, { 123.03778533, 168.84353204, 2.79618024 }, { 122.09557241, 169.17853968, 2.80368640 }, { 121.15088654, 169.50650924, 2.81110100 }, { 120.20380971, 169.82750924, 2.81842393 }, { 119.25442213, 170.14160932, 2.82565508 }, { 118.30280228, 170.44888025, 2.83279437 }, { 117.34902690, 170.74939380, 2.83984174 }, { 116.39317099, 171.04322274, 2.84679714 }, { 115.43530781, 171.33044079, 2.85366054 }, { 114.47550891, 171.61112254, 2.86043191 }, { 113.51384412, 171.88534346, 2.86711127 }, { 112.55038157, 172.15317977, 2.87369864 }, { 111.58518769, 172.41470849, 2.88019404 }, { 110.61832726, 172.67000730, 2.88659753 }, { 109.64986336, 172.91915457, 2.89290919 }, { 108.67985745, 173.16222927, 2.89912909 }, { 107.70836934, 173.39931094, 2.90525735 }, { 106.73545722, 173.63047966, 2.91129408 }, { 105.76117769, 173.85581599, 2.91723942 }, { 104.78558577, 174.07540091, 2.92309353 }, { 103.80873489, 174.28931584, 2.92885657 }, { 102.83067696, 174.49764253, 2.93452873 }, { 101.85146236, 174.70046305, 2.94011022 }, { 100.87113995, 174.89785978, 2.94560126 }, { 99.88975713, 175.08991530, 2.95100208 }, { 98.90735982, 175.27671244, 2.95631295 }, { 97.92399250, 175.45833415, 2.96153413 }, { 96.93969824, 175.63486354, 2.96666590 }, { 95.95451873, 175.80638381, 2.97170858 }, { 94.96849426, 175.97297822, 2.97666249 }, { 93.98166379, 176.13473004, 2.98152795 }, { 92.99406495, 176.29172254, 2.98630533 }, { 92.00573410, 176.44403896, 2.99099498 }, { 91.01670629, 176.59176244, 2.99559731 }, { 90.02701534, 176.73497603, 3.00011271 }, { 89.03669386, 176.87376263, 3.00454159 }, { 88.04577324, 177.00820499, 3.00888439 }, { 87.05428371, 177.13838565, 3.01314155 }, { 86.06225436, 177.26438691, 3.01731356 }, { 85.06971315, 177.38629083, 3.02140087 }, { 84.07668697, 177.50417917, 3.02540400 }, { 83.08320161, 177.61813340, 3.02932344 }, { 82.08928185, 177.72823464, 3.03315974 }, { 81.09495144, 177.83456364, 3.03691343 }, { 80.10023313, 177.93720075, 3.04058506 }, { 79.10514875, 178.03622594, 3.04417522 }, { 78.10971914, 178.13171870, 3.04768448 }, { 77.11396426, 178.22375808, 3.05111346 }, { 76.11790319, 178.31242263, 3.05446277 }, { 75.12155413, 178.39779041, 3.05773303 }, { 74.12493445, 178.47993892, 3.06092490 }, { 73.12806073, 178.55894512, 3.06403904 }, { 72.13094875, 178.63488540, 3.06707613 }, { 71.13361353, 178.70783555, 3.07003684 }, { 70.13606935, 178.77787073, 3.07292190 }, { 69.13832981, 178.84506548, 3.07573200 }, { 68.14040777, 178.90949368, 3.07846789 }, { 67.14231548, 178.97122853, 3.08113031 }, { 66.14406453, 179.03034254, 3.08372002 }, { 65.14566587, 179.08690752, 3.08623779 }, { 64.14712989, 179.14099453, 3.08868440 }, { 63.14846640, 179.19267391, 3.09106065 }, { 62.14968465, 179.24201521, 3.09336736 }, { 61.15079336, 179.28908722, 3.09560534 }, { 60.15180075, 179.33395793, 3.09777544 }, { 59.15271456, 179.37669451, 3.09987851 }, { 58.15354205, 179.41736333, 3.10191539 }, { 57.15429004, 179.45602989, 3.10388698 }, { 56.15496493, 179.49275885, 3.10579414 }, { 55.15557270, 179.52761400, 3.10763779 }, { 54.15611894, 179.56065824, 3.10941883 }, { 53.15660888, 179.59195358, 3.11113818 }, { 52.15704740, 179.62156111, 3.11279677 }, { 51.15743902, 179.64954102, 3.11439554 }, { 50.15778796, 179.67595253, 3.11593546 }, { 49.15809814, 179.70085395, 3.11741747 }, { 48.15837318, 179.72430260, 3.11884257 }, { 47.15861644, 179.74635485, 3.12021174 }, { 46.15883101, 179.76706606, 3.12152596 }, { 45.15901975, 179.78649063, 3.12278626 }, { 44.15918529, 179.80468192, 3.12399364 }, { 43.15933003, 179.82169231, 3.12514913 }, { 42.15945619, 179.83757312, 3.12625377 }, { 41.15956579, 179.85237466, 3.12730861 }, { 40.15966066, 179.86614618, 3.12831468 }, { 39.15974249, 179.87893589, 3.12927307 }, { 38.15981280, 179.89079091, 3.13018484 }, { 37.15987296, 179.90175730, 3.13105107 }, { 36.15992423, 179.91188005, 3.13187286 }, { 35.15996771, 179.92120304, 3.13265129 }, { 34.16000442, 179.92976905, 3.13338747 }, { 33.16003526, 179.93761978, 3.13408252 }, { 32.16006103, 179.94479577, 3.13473756 }, { 31.16008243, 179.95133647, 3.13535371 }, { 30.16010011, 179.95728018, 3.13593211 }, { 29.16011462, 179.96266410, 3.13647390 }, { 28.16012644, 179.96752423, 3.13698023 }, { 27.16013600, 179.97189545, 3.13745226 }, { 26.16014368, 179.97581148, 3.13789114 }, { 25.16014979, 179.97930489, 3.13829805 }, { 24.16015460, 179.98240704, 3.13867415 }, { 23.16015837, 179.98514814, 3.13902063 }, { 22.16016127, 179.98755723, 3.13933868 }, { 21.16016349, 179.98966213, 3.13962947 }, { 20.16016516, 179.99148950, 3.13989421 }, { 19.16016641, 179.99306478, 3.14013410 }, { 18.16016732, 179.99441221, 3.14035033 }, { 17.16016797, 179.99555485, 3.14054412 }, { 16.16016843, 179.99651452, 3.14071669 }, { 15.16016875, 179.99731183, 3.14086924 }, { 14.16016897, 179.99796618, 3.14100300 }, { 13.16016911, 179.99849574, 3.14111919 }, { 12.16016920, 179.99891747, 3.14121904 }, { 11.16016925, 179.99924708, 3.14130378 }, { 10.16016928, 179.99949906, 3.14137464 }, { 9.16016930, 179.99968667, 3.14143286 }, { 8.16016931, 179.99982193, 3.14147967 }, { 7.16016931, 179.99991562, 3.14151631 }, { 6.16016932, 179.99997727, 3.14154403 }, { 5.16016932, 180.00001518, 3.14156407 }, { 4.16016932, 180.00003641, 3.14157768 }, { 3.16016932, 180.00004676, 3.14158609 }, { 2.16016932, 180.00005079, 3.14159056 }, { 1.16016932, 180.00005182, 3.14159233 }, { 0.00000000, 180.00000000, 3.14159265 }, };
//
//		switch (action) {
//		case LEFT_45:
//			return data_45[index];
//		case RIGHT_45:
//			return data_45[index].mirror_x();
//
//		case LEFT_45_45:
//			return data_45_45[index];
//		case RIGHT_45_45:
//			return data_45_45[index].mirror_x();
//
//		case LEFT_90:
//			return data_90[index];
//		case RIGHT_90:
//			return data_90[index].mirror_x();
//
//		case LEFT_135:
//			return data_90[index];
//		case RIGHT_135:
//			return data_135[index].mirror_x();
//
//		case LEFT_180:
//			return data_180[index];
//		case RIGHT_180:
//			return data_180[index].mirror_x();
//		}
//	}
//};

class Curve90: public Trajectory {
public:
	Curve90(bool mirror = false) :
			Trajectory(), mirror(mirror) {
	}
private:
	bool mirror;
	virtual int size() const {
		return 158;
	}
	virtual Position position(int index) const {
		static const float data[158 + 1][3] =
				{ { 0, 0, 0 }, { 1, 0, 0 }, { 2, 0, 0 }, { 3, 0, 0 }, { 4, 0, 0 }, { 5, 0, 0 }, { 6, 0, 0 }, { 7, 0, 0 }, { 8, 0, 0 }, { 9, 0, 0 }, { 10, 0, 0 }, { 11, 0, 0 }, { 12, 0, 0 }, { 13, 0, 0 }, { 14, 0, 0 }, { 15, 0, 0 }, { 16, 0, 0 }, { 17, 0, 0 }, { 18, 0, 0 }, { 19, 0, 0 }, { 20, 0, 0 }, { 21.002, 1.4543e-05, 7.5223e-05 }, { 22.002, 0.00030398, 0.00057718 }, { 23.002, 0.0013334, 0.0015505 }, { 24.002, 0.0035741, 0.0029951 }, { 25.002, 0.0074974, 0.004911 }, { 26.001, 0.013575, 0.0072982 }, { 27.001, 0.022277, 0.010157 }, { 28.001, 0.034076, 0.013487 }, { 29.001, 0.049442, 0.017288 }, { 30.001, 0.068847, 0.02156 }, { 31.001, 0.092762, 0.026304 }, { 32, 0.12166, 0.031519 }, { 33, 0.156, 0.037206 }, { 33.999, 0.19627, 0.043364 }, { 34.998, 0.24292, 0.049993 }, { 35.996, 0.29644, 0.057093 }, { 36.995, 0.35728, 0.064665 }, { 37.992, 0.42591, 0.072708 }, { 38.989, 0.5028, 0.081223 }, { 39.986, 0.58842, 0.090208 }, { 40.981, 0.68322, 0.099665 }, { 41.976, 0.78767, 0.10959 }, { 42.969, 0.90222, 0.11999 }, { 43.961, 1.0273, 0.13086 }, { 44.952, 1.1635, 0.14221 }, { 45.941, 1.3111, 0.15402 }, { 46.928, 1.4706, 0.16631 }, { 47.913, 1.6424, 0.17906 }, { 48.896, 1.827, 0.19229 }, { 49.876, 2.0249, 0.20599 }, { 50.854, 2.2364, 0.22016 }, { 51.828, 2.4619, 0.2348 }, { 52.799, 2.702, 0.24991 }, { 53.766, 2.9569, 0.2655 }, { 54.728, 3.227, 0.28155 }, { 55.687, 3.5128, 0.29808 }, { 56.64, 3.8147, 0.31508 }, { 57.588, 4.1329, 0.33255 }, { 58.53, 4.4679, 0.35049 }, { 59.466, 4.8199, 0.3689 }, { 60.395, 5.1893, 0.38778 }, { 61.317, 5.5764, 0.40714 }, { 62.232, 5.9816, 0.42696 }, { 63.138, 6.4049, 0.44726 }, { 64.035, 6.8468, 0.46803 }, { 64.922, 7.3075, 0.48927 }, { 65.8, 7.787, 0.51098 }, { 66.666, 8.2858, 0.53317 }, { 67.522, 8.8038, 0.55582 }, { 68.365, 9.3413, 0.57894 }, { 69.195, 9.8983, 0.60247 }, { 70.013, 10.475, 0.62604 }, { 70.816, 11.07, 0.64962 }, { 71.605, 11.685, 0.67319 }, { 72.379, 12.317, 0.69676 }, { 73.138, 12.968, 0.72034 }, { 73.882, 13.637, 0.74391 }, { 74.61, 14.323, 0.76748 }, { 75.321, 15.025, 0.79106 }, { 76.016, 15.745, 0.81463 }, { 76.693, 16.48, 0.8382 }, { 77.353, 17.232, 0.86178 }, { 77.995, 17.998, 0.88535 }, { 78.619, 18.78, 0.90892 }, { 79.224, 19.576, 0.93249 }, { 79.81, 20.386, 0.95607 }, { 80.377, 21.21, 0.97964 }, { 80.925, 22.047, 1.003 }, { 81.452, 22.896, 1.0259 }, { 81.961, 23.757, 1.0483 }, { 82.45, 24.629, 1.0703 }, { 82.921, 25.511, 1.0918 }, { 83.372, 26.404, 1.1128 }, { 83.805, 27.305, 1.1333 }, { 84.219, 28.215, 1.1534 }, { 84.615, 29.133, 1.173 }, { 84.994, 30.059, 1.1921 }, { 85.355, 30.992, 1.2108 }, { 85.698, 31.931, 1.229 }, { 86.025, 32.876, 1.2467 }, { 86.335, 33.827, 1.2639 }, { 86.629, 34.782, 1.2807 }, { 86.907, 35.743, 1.297 }, { 87.17, 36.708, 1.3128 }, { 87.417, 37.677, 1.3282 }, { 87.65, 38.649, 1.3431 }, { 87.869, 39.625, 1.3575 }, { 88.074, 40.604, 1.3714 }, { 88.265, 41.585, 1.3849 }, { 88.443, 42.569, 1.3979 }, { 88.609, 43.555, 1.4104 }, { 88.763, 44.544, 1.4225 }, { 88.905, 45.533, 1.4341 }, { 89.035, 46.525, 1.4452 }, { 89.155, 47.518, 1.4559 }, { 89.265, 48.512, 1.466 }, { 89.364, 49.507, 1.4757 }, { 89.455, 50.503, 1.485 }, { 89.536, 51.499, 1.4937 }, { 89.609, 52.497, 1.502 }, { 89.673, 53.494, 1.5098 }, { 89.731, 54.493, 1.5172 }, { 89.781, 55.492, 1.524 }, { 89.824, 56.491, 1.5304 }, { 89.862, 57.49, 1.5364 }, { 89.893, 58.489, 1.5418 }, { 89.92, 59.489, 1.5468 }, { 89.941, 60.489, 1.5513 }, { 89.959, 61.489, 1.5554 }, { 89.972, 62.489, 1.559 }, { 89.982, 63.489, 1.5621 }, { 89.99, 64.489, 1.5647 }, { 89.995, 65.488, 1.5669 }, { 89.998, 66.488, 1.5686 }, { 89.999, 67.488, 1.5698 }, { 90, 68.488, 1.5705 }, { 90, 69.488, 1.5708 }, { 90, 70.478, 1.5708 }, { 90, 71.478, 1.5708 }, { 90, 72.478, 1.5708 }, { 90, 73.478, 1.5708 }, { 90, 74.478, 1.5708 }, { 90, 75.478, 1.5708 }, { 90, 76.478, 1.5708 }, { 90, 77.478, 1.5708 }, { 90, 78.478, 1.5708 }, { 90, 79.478, 1.5708 }, { 90, 80.478, 1.5708 }, { 90, 81.478, 1.5708 }, { 90, 82.478, 1.5708 }, { 90, 83.478, 1.5708 }, { 90, 84.478, 1.5708 }, { 90, 85.478, 1.5708 }, { 90, 86.478, 1.5708 }, { 90, 87.478, 1.5708 }, { 90, 88.478, 1.5708 }, { 90, 89.478, 1.5708 }, { 90, 90, 1.5708 }, };
		Position ret;
		if (index < 0) {
			ret = Position(0 + interval * index, 0, 0);
		} else if (index > size() - 1) {
			Position end(data[size()][0], data[size()][1], data[size()][2]);
			ret = end
					+ Position((index - size()) * interval * cos(end.theta),
							(index - size()) * interval * sin(end.theta), 0);
		} else {
			ret = Position(data[index][0], data[index][1], data[index][2]);
		}
		if (mirror)
			return ret.mirror_x();
		return ret;
	}
};

class C45: public Trajectory {
public:
	C45(bool mirror = false) :
			Trajectory(), mirror(mirror) {
	}
private:
	bool mirror;
	virtual int size() const {
		return 174;
	}
	virtual Position position(int index) const {
		static const float data[175][3] =
				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000024, 0.00000095 }, { 2.00000000, 0.00000388, 0.00000772 }, { 3.00000000, 0.00001970, 0.00002617 }, { 4.00000000, 0.00006234, 0.00006216 }, { 4.99999999, 0.00015228, 0.00012152 }, { 5.99999998, 0.00031584, 0.00021004 }, { 6.99999994, 0.00058507, 0.00033350 }, { 7.99999986, 0.00099782, 0.00049760 }, { 8.99999968, 0.00159758, 0.00070800 }, { 9.99999932, 0.00243349, 0.00097032 }, { 10.99999868, 0.00356028, 0.00129009 }, { 11.99999759, 0.00503815, 0.00167276 }, { 12.99999578, 0.00693272, 0.00212371 }, { 13.99999293, 0.00931497, 0.00264824 }, { 14.99998858, 0.01226110, 0.00325154 }, { 15.99998211, 0.01585245, 0.00393870 }, { 16.99997274, 0.02017540, 0.00471469 }, { 17.99995947, 0.02532127, 0.00558440 }, { 18.99994104, 0.03138615, 0.00655255 }, { 19.99991589, 0.03847083, 0.00762378 }, { 20.99988214, 0.04668065, 0.00880255 }, { 21.99983746, 0.05612534, 0.01009321 }, { 22.99977913, 0.06691890, 0.01149995 }, { 23.99970387, 0.07917944, 0.01302683 }, { 24.99960785, 0.09302903, 0.01467772 }, { 25.99948658, 0.10859354, 0.01645636 }, { 26.99933488, 0.12600245, 0.01836630 }, { 27.99914677, 0.14538871, 0.02041093 }, { 28.99891543, 0.16688854, 0.02259347 }, { 29.99863307, 0.19064127, 0.02491695 }, { 30.99829090, 0.21678911, 0.02738423 }, { 31.99787903, 0.24547701, 0.02999795 }, { 32.99738638, 0.27685244, 0.03276061 }, { 33.99680060, 0.31106517, 0.03567446 }, { 34.99610798, 0.34826708, 0.03874161 }, { 35.99529336, 0.38861198, 0.04196392 }, { 36.99434006, 0.43225535, 0.04534308 }, { 37.99322977, 0.47935415, 0.04888056 }, { 38.99194250, 0.53006660, 0.05257763 }, { 39.99045645, 0.58455192, 0.05643535 }, { 40.98874797, 0.64297018, 0.06045458 }, { 41.98679146, 0.70548199, 0.06463595 }, { 42.98455931, 0.77224832, 0.06897990 }, { 43.98202181, 0.84343025, 0.07348665 }, { 44.97914710, 0.91918873, 0.07815619 }, { 45.97590109, 0.99968435, 0.08298833 }, { 46.97224741, 1.08507711, 0.08798265 }, { 47.96814738, 1.17552615, 0.09313851 }, { 48.96355994, 1.27118956, 0.09845509 }, { 49.95844160, 1.37222408, 0.10393133 }, { 50.95274646, 1.47878491, 0.10956597 }, { 51.94642612, 1.59102545, 0.11535755 }, { 52.93942971, 1.70909706, 0.12130441 }, { 53.93170390, 1.83314882, 0.12740468 }, { 54.92319283, 1.96332732, 0.13365628 }, { 55.91383820, 2.09977639, 0.14005695 }, { 56.90357922, 2.24263689, 0.14660424 }, { 57.89235273, 2.39204649, 0.15329547 }, { 58.88009313, 2.54813945, 0.16012783 }, { 59.86673252, 2.71104635, 0.16709828 }, { 60.85220073, 2.88089395, 0.17420363 }, { 61.83642536, 3.05780493, 0.18144049 }, { 62.81933193, 3.24189772, 0.18880532 }, { 63.80084391, 3.43328627, 0.19629439 }, { 64.78088282, 3.63207987, 0.20390383 }, { 65.75936841, 3.83838301, 0.21162961 }, { 66.73621869, 4.05229513, 0.21946754 }, { 67.71135015, 4.27391052, 0.22741328 }, { 68.68467782, 4.50331812, 0.23546236 }, { 69.65611547, 4.74060141, 0.24361018 }, { 70.62557576, 4.98583821, 0.25185200 }, { 71.59297038, 5.23910064, 0.26018295 }, { 72.55821027, 5.50045492, 0.26859807 }, { 73.52120575, 5.76996132, 0.27709227 }, { 74.48186674, 6.04767402, 0.28566036 }, { 75.44010295, 6.33364107, 0.29429706 }, { 76.39582406, 6.62790429, 0.30299699 }, { 77.34893997, 6.93049920, 0.31175470 }, { 78.29936093, 7.24145503, 0.32056466 }, { 79.24699783, 7.56079462, 0.32942127 }, { 80.19176236, 7.88853441, 0.33831887 }, { 81.13356727, 8.22468447, 0.34725175 }, { 82.07232653, 8.56924848, 0.35621414 }, { 83.00795560, 8.92222372, 0.36520026 }, { 83.94037161, 9.28360114, 0.37420426 }, { 84.86949358, 9.65336538, 0.38322031 }, { 85.79524265, 10.03149481, 0.39224253 }, { 86.71754228, 10.41796165, 0.40126504 }, { 87.63631843, 10.81273197, 0.41028198 }, { 88.55149980, 11.21576583, 0.41928747 }, { 89.46301800, 11.62701739, 0.42827566 }, { 90.37080774, 12.04643496, 0.43724072 }, { 91.27480700, 12.47396119, 0.44617685 }, { 92.17495724, 12.90953317, 0.45507828 }, { 93.07120352, 13.35308256, 0.46393929 }, { 93.96349469, 13.80453576, 0.47275423 }, { 94.85178353, 14.26381404, 0.48151748 }, { 95.73602685, 14.73083377, 0.49022351 }, { 96.61618569, 15.20550650, 0.49886685 }, { 97.49222534, 15.68773923, 0.50744213 }, { 98.36411553, 16.17743452, 0.51594404 }, { 99.23183046, 16.67449073, 0.52436740 }, { 100.09534893, 17.17880220, 0.53270710 }, { 100.95465435, 17.69025946, 0.54095816 }, { 101.80973483, 18.20874940, 0.54911570 }, { 102.66058323, 18.73415552, 0.55717499 }, { 103.50719715, 19.26635811, 0.56513139 }, { 104.34957898, 19.80523446, 0.57298043 }, { 105.18773589, 20.35065908, 0.58071775 }, { 106.02167980, 20.90250391, 0.58833915 }, { 106.85142739, 21.46063852, 0.59584059 }, { 107.67700005, 22.02493032, 0.60321816 }, { 108.49842382, 22.59524481, 0.61046813 }, { 109.31572934, 23.17144570, 0.61758694 }, { 110.12895177, 23.75339520, 0.62457119 }, { 110.93813071, 24.34095417, 0.63141767 }, { 111.74331010, 24.93398233, 0.63812332 }, { 112.54453813, 25.53233846, 0.64468529 }, { 113.34186707, 26.13588061, 0.65110091 }, { 114.13535322, 26.74446623, 0.65736771 }, { 114.92505670, 27.35795241, 0.66348338 }, { 115.71104135, 27.97619603, 0.66944586 }, { 116.49337454, 28.59905394, 0.67525323 }, { 117.27212704, 29.22638311, 0.68090383 }, { 118.04737281, 29.85804084, 0.68639615 }, { 118.81918886, 30.49388486, 0.69172894 }, { 119.58765503, 31.13377352, 0.69690111 }, { 120.35285385, 31.77756595, 0.70191181 }, { 121.11487026, 32.42512215, 0.70676038 }, { 121.87379149, 33.07630317, 0.71144639 }, { 122.62970683, 33.73097126, 0.71596961 }, { 123.38270738, 34.38898994, 0.72033003 }, { 124.13288592, 35.05022416, 0.72452784 }, { 124.88033660, 35.71454044, 0.72856345 }, { 125.62515481, 36.38180694, 0.73243748 }, { 126.36743692, 37.05189360, 0.73615076 }, { 127.10728005, 37.72467223, 0.73970434 }, { 127.84478191, 38.40001662, 0.74309945 }, { 128.58004051, 39.07780267, 0.74633756 }, { 129.31315399, 39.75790841, 0.74942033 }, { 130.04422043, 40.44021417, 0.75234961 }, { 130.77333755, 41.12460265, 0.75512746 }, { 131.50060259, 41.81095896, 0.75775615 }, { 132.22611206, 42.49917076, 0.76023812 }, { 132.94996156, 43.18912833, 0.76257603 }, { 133.67224554, 43.88072464, 0.76477270 }, { 134.39305716, 44.57385541, 0.76683114 }, { 135.11248804, 45.26841922, 0.76875456 }, { 135.83062814, 45.96431759, 0.77054633 }, { 136.54756553, 46.66145498, 0.77220998 }, { 137.26338623, 47.35973896, 0.77374923 }, { 137.97817407, 48.05908021, 0.77516795 }, { 138.69201047, 48.75939261, 0.77647017 }, { 139.40497433, 49.46059331, 0.77766007 }, { 140.11714188, 50.16260276, 0.77874197 }, { 140.82858652, 50.86534485, 0.77972035 }, { 141.53937870, 51.56874688, 0.78059980 }, { 142.24958576, 52.27273969, 0.78138506 }, { 142.95927187, 52.97725768, 0.78208099 }, { 143.66849785, 53.68223887, 0.78269254 }, { 144.37732111, 54.38762498, 0.78322481 }, { 145.08579554, 55.09336145, 0.78368297 }, { 145.79397141, 55.79939751, 0.78407231 }, { 146.50189529, 56.50568625, 0.78439819 }, { 147.20960998, 57.21218459, 0.78466607 }, { 147.91715445, 57.91885341, 0.78488148 }, { 148.62456374, 58.62565755, 0.78505000 }, { 149.33186896, 59.33256583, 0.78517731 }, { 150.03909719, 60.03955114, 0.78526911 }, { 150.74627148, 60.74659040, 0.78533116 }, { 151.45341080, 61.45366465, 0.78536925 }, { 152.16053001, 62.16075900, 0.78538921 }, { 152.86763983, 62.86786275, 0.78539689 }, { 153.63838646, 63.63860890, 0.78539816 }, };
		Position ret;
		if (index < 0) {
			ret = Position(0 + interval * index, 0, 0);
		} else if (index > size() - 1) {
			Position end(data[size()][0], data[size()][1], data[size()][2]);
			ret = end
					+ Position((index - size()) * interval * cos(end.theta),
							(index - size()) * interval * sin(end.theta), 0);
		} else {
			ret = Position(data[index][0], data[index][1], data[index][2]);
		}
		if (mirror)
			return ret.mirror_x();
		return ret;
	}
};

class C4545: public Trajectory {
public:
	C4545(bool mirror = false) :
			Trajectory(), mirror(mirror) {
	}
private:
	bool mirror;
	virtual int size() const {
		return 217;
	}
	virtual Position position(int index) const {
		static const float data[218][3] =
				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000025, 0.00000097 }, { 2.00000000, 0.00000396, 0.00000788 }, { 3.00000000, 0.00002012, 0.00002674 }, { 4.00000000, 0.00006369, 0.00006352 }, { 4.99999999, 0.00015561, 0.00012420 }, { 5.99999998, 0.00032279, 0.00021473 }, { 6.99999994, 0.00059807, 0.00034104 }, { 7.99999985, 0.00102023, 0.00050903 }, { 8.99999966, 0.00163389, 0.00072456 }, { 9.99999929, 0.00248956, 0.00099345 }, { 10.99999862, 0.00364350, 0.00132149 }, { 11.99999747, 0.00515777, 0.00171440 }, { 12.99999557, 0.00710011, 0.00217787 }, { 13.99999258, 0.00954391, 0.00271750 }, { 14.99998799, 0.01256814, 0.00333885 }, { 15.99998116, 0.01625732, 0.00404741 }, { 16.99997126, 0.02070137, 0.00484859 }, { 17.99995721, 0.02599562, 0.00574773 }, { 18.99993767, 0.03224068, 0.00675008 }, { 19.99991096, 0.03954237, 0.00786081 }, { 20.99987503, 0.04801164, 0.00908500 }, { 21.99982740, 0.05776444, 0.01042764 }, { 22.99976506, 0.06892168, 0.01189360 }, { 23.99968447, 0.08160907, 0.01348768 }, { 24.99958141, 0.09595706, 0.01521454 }, { 25.99945094, 0.11210070, 0.01707876 }, { 26.99928734, 0.13017951, 0.01908478 }, { 27.99908396, 0.15033741, 0.02123695 }, { 28.99883316, 0.17272255, 0.02353946 }, { 29.99852621, 0.19748720, 0.02599641 }, { 30.99815320, 0.22478761, 0.02861176 }, { 31.99770289, 0.25478386, 0.03138933 }, { 32.99716263, 0.28763976, 0.03433282 }, { 33.99651823, 0.32352263, 0.03744577 }, { 34.99575384, 0.36260323, 0.04073160 }, { 35.99485183, 0.40505554, 0.04419358 }, { 36.99379267, 0.45105663, 0.04783483 }, { 37.99255477, 0.50078647, 0.05165832 }, { 38.99111437, 0.55442778, 0.05566687 }, { 39.98944540, 0.61216585, 0.05986316 }, { 40.98751934, 0.67418837, 0.06424968 }, { 41.98530510, 0.74068519, 0.06882879 }, { 42.98276885, 0.81184822, 0.07360269 }, { 43.97987389, 0.88787113, 0.07857340 }, { 44.97658052, 0.96894926, 0.08374279 }, { 45.97284590, 1.05527932, 0.08911256 }, { 46.96862392, 1.14705924, 0.09468425 }, { 47.96386503, 1.24448792, 0.10045921 }, { 48.95851616, 1.34776502, 0.10643865 }, { 49.95252053, 1.45709078, 0.11262360 }, { 50.94581758, 1.57266570, 0.11901490 }, { 51.93834282, 1.69469039, 0.12561324 }, { 52.93002770, 1.82336530, 0.13241914 }, { 53.92079954, 1.95889046, 0.13943293 }, { 54.91058137, 2.10146526, 0.14665478 }, { 55.89929189, 2.25128821, 0.15408467 }, { 56.88684532, 2.40855664, 0.16172244 }, { 57.87315136, 2.57346648, 0.16956772 }, { 58.85811511, 2.74621201, 0.17761999 }, { 59.84163697, 2.92698553, 0.18587854 }, { 60.82361262, 3.11597720, 0.19434252 }, { 61.80393296, 3.31337465, 0.20301088 }, { 62.78248409, 3.51936283, 0.21188240 }, { 63.75914726, 3.73412363, 0.22095570 }, { 64.73379886, 3.95783569, 0.23022925 }, { 65.70631046, 4.19067408, 0.23970131 }, { 66.67654877, 4.43281005, 0.24937001 }, { 67.64437571, 4.68441075, 0.25923332 }, { 68.60964841, 4.94563895, 0.26928901 }, { 69.57221932, 5.21665279, 0.27953473 }, { 70.53193621, 5.49760550, 0.28996794 }, { 71.48864229, 5.78864514, 0.30058598 }, { 72.44217632, 6.08991434, 0.31138600 }, { 73.39237269, 6.40155004, 0.32236502 }, { 74.33906157, 6.72368325, 0.33351991 }, { 75.28206901, 7.05643881, 0.34484738 }, { 76.22121717, 7.39993513, 0.35634401 }, { 77.15632442, 7.75428397, 0.36800623 }, { 78.08720555, 8.11959024, 0.37983034 }, { 79.01367199, 8.49595174, 0.39181250 }, { 79.93553197, 8.88345902, 0.40394875 }, { 80.85259083, 9.28219512, 0.41623498 }, { 81.76465116, 9.69223544, 0.42866697 }, { 82.67151315, 10.11364754, 0.44124037 }, { 83.57297478, 10.54649100, 0.45395074 }, { 84.46883215, 10.99081727, 0.46679348 }, { 85.35887973, 11.44666954, 0.47976392 }, { 86.24291069, 11.91408260, 0.49285726 }, { 87.12071720, 12.39308280, 0.50606860 }, { 87.99209073, 12.88368791, 0.51939297 }, { 88.85682242, 13.38590705, 0.53282525 }, { 89.71470337, 13.89974070, 0.54636029 }, { 90.56552499, 14.42518058, 0.55999282 }, { 91.40907939, 14.96220971, 0.57371750 }, { 92.24515966, 15.51080235, 0.58752890 }, { 93.07356029, 16.07092405, 0.60142153 }, { 93.89407747, 16.64253169, 0.61538984 }, { 94.70650951, 17.22557350, 0.62942820 }, { 95.51065716, 17.81998918, 0.64353093 }, { 96.30632394, 18.42570995, 0.65769229 }, { 97.09331659, 19.04265868, 0.67190651 }, { 97.87144532, 19.67075002, 0.68616775 }, { 98.64052423, 20.30989052, 0.70047015 }, { 99.40037162, 20.95997883, 0.71480781 }, { 100.15081035, 21.62090585, 0.72917479 }, { 100.89166815, 22.29255492, 0.74356515 }, { 101.62277795, 22.97480206, 0.75797291 }, { 102.34397821, 23.66751618, 0.77239207 }, { 103.05511321, 24.37055934, 0.78681665 }, { 103.75603333, 25.08378696, 0.80124064 }, { 104.44659537, 25.80704816, 0.81565803 }, { 105.12666276, 26.54018597, 0.83006284 }, { 105.79610586, 27.28303770, 0.84444907 }, { 106.45480219, 28.03543517, 0.85881076 }, { 107.10263665, 28.79720509, 0.87314195 }, { 107.73950171, 29.56816933, 0.88743672 }, { 108.36529764, 30.34814531, 0.90168918 }, { 108.97993265, 31.13694629, 0.91589346 }, { 109.58332308, 31.93438174, 0.93004375 }, { 110.17539352, 32.74025770, 0.94413427 }, { 110.75607693, 33.55437709, 0.95815930 }, { 111.32531477, 34.37654013, 0.97211317 }, { 111.88305705, 35.20654465, 0.98599026 }, { 112.42926243, 36.04418647, 0.99978504 }, { 112.96389827, 36.88925976, 1.01349202 }, { 113.48694064, 37.74155739, 1.02710579 }, { 113.99837434, 38.60087127, 1.04062104 }, { 114.49819293, 39.46699273, 1.05403251 }, { 114.98639865, 40.33971287, 1.06733504 }, { 115.46300244, 41.21882284, 1.08052357 }, { 115.92802383, 42.10411424, 1.09359312 }, { 116.38149093, 42.99537943, 1.10653882 }, { 116.82344027, 43.89241181, 1.11935590 }, { 117.25391676, 44.79500617, 1.13203968 }, { 117.67297355, 45.70295898, 1.14458563 }, { 118.08067186, 46.61606864, 1.15698929 }, { 118.47708091, 47.53413583, 1.16924635 }, { 118.86227766, 48.45696368, 1.18135262 }, { 119.23634675, 49.38435810, 1.19330401 }, { 119.59938023, 50.31612798, 1.20509658 }, { 119.95147739, 51.25208542, 1.21672652 }, { 120.29274456, 52.19204593, 1.22819016 }, { 120.62329491, 53.13582866, 1.23948395 }, { 120.94324820, 54.08325654, 1.25060451 }, { 121.25273055, 55.03415648, 1.26154857 }, { 121.55187422, 55.98835951, 1.27231303 }, { 121.84081736, 56.94570090, 1.28289494 }, { 122.11970372, 57.90602032, 1.29329148 }, { 122.38868247, 58.86916192, 1.30350002 }, { 122.64790786, 59.83497445, 1.31351806 }, { 122.89753903, 60.80331129, 1.32334326 }, { 123.13773966, 61.77403058, 1.33297345 }, { 123.36867777, 62.74699521, 1.34240662 }, { 123.59052543, 63.72207290, 1.35164091 }, { 123.80345847, 64.69913622, 1.36067465 }, { 124.00765621, 65.67806256, 1.36950632 }, { 124.20330122, 66.65873418, 1.37813457 }, { 124.39057899, 67.64103817, 1.38655822 }, { 124.56967774, 68.62486641, 1.39477627 }, { 124.74078805, 69.61011558, 1.40278788 }, { 124.90410269, 70.59668704, 1.41059239 }, { 125.05981627, 71.58448686, 1.41818929 }, { 125.20812505, 72.57342566, 1.42557828 }, { 125.34922662, 73.56341862, 1.43275921 }, { 125.48331969, 74.55438531, 1.43973209 }, { 125.61060381, 75.54624969, 1.44649714 }, { 125.73127911, 76.53893992, 1.45305472 }, { 125.84554609, 77.53238831, 1.45940538 }, { 125.95360536, 78.52653118, 1.46554983 }, { 126.05565739, 79.52130876, 1.47148898 }, { 126.15190231, 80.51666507, 1.47722386 }, { 126.24253964, 81.51254776, 1.48275573 }, { 126.32776812, 82.50890800, 1.48808596 }, { 126.40778542, 83.50570038, 1.49321614 }, { 126.48278800, 84.50288270, 1.49814799 }, { 126.55297085, 85.50041591, 1.50288342 }, { 126.61852732, 86.49826391, 1.50742447 }, { 126.67964888, 87.49639345, 1.51177339 }, { 126.73652499, 88.49477397, 1.51593255 }, { 126.78934282, 89.49337748, 1.51990449 }, { 126.83828716, 90.49217839, 1.52369191 }, { 126.88354017, 91.49115340, 1.52729766 }, { 126.92528124, 92.49028138, 1.53072475 }, { 126.96368682, 93.48954317, 1.53397632 }, { 126.99893023, 94.48892153, 1.53705567 }, { 127.03118153, 95.48840097, 1.53996624 }, { 127.06060734, 96.48796762, 1.54271161 }, { 127.08737069, 97.48760914, 1.54529550 }, { 127.11163089, 98.48731458, 1.54772177 }, { 127.13354339, 99.48707425, 1.54999439 }, { 127.15325960, 100.48687968, 1.55211747 }, { 127.17092682, 101.48672344, 1.55409526 }, { 127.18668807, 102.48659909, 1.55593211 }, { 127.20068195, 103.48650105, 1.55763250 }, { 127.21304257, 104.48642455, 1.55920100 }, { 127.22389941, 105.48636552, 1.56064233 }, { 127.23337720, 106.48632054, 1.56196128 }, { 127.24159582, 107.48628670, 1.56316276 }, { 127.24867022, 108.48626163, 1.56425177 }, { 127.25471027, 109.48624335, 1.56523341 }, { 127.25982074, 110.48623026, 1.56611287 }, { 127.26410115, 111.48622107, 1.56689541 }, { 127.26764570, 112.48621477, 1.56758639 }, { 127.27054324, 113.48621056, 1.56819124 }, { 127.27287711, 114.48620782, 1.56871545 }, { 127.27472515, 115.48620611, 1.56916459 }, { 127.27615959, 116.48620507, 1.56954429 }, { 127.27724699, 117.48620448, 1.56986025 }, { 127.27804821, 118.48620415, 1.57011819 }, { 127.27861835, 119.48620399, 1.57032391 }, { 127.27900669, 120.48620391, 1.57048324 }, { 127.27925665, 121.48620388, 1.57060204 }, { 127.27940578, 122.48620387, 1.57068624 }, { 127.27948570, 123.48620386, 1.57074174 }, { 127.27952208, 124.48620386, 1.57077453 }, { 127.27953464, 125.48620386, 1.57079056 }, { 127.27922061, 127.27922061, 1.57079633 }, };
		Position ret;
		if (index < 0) {
			ret = Position(0 + interval * index, 0, 0);
		} else if (index > size() - 1) {
			Position end(data[size()][0], data[size()][1], data[size()][2]);
			ret = end
					+ Position((index - size()) * interval * cos(end.theta),
							(index - size()) * interval * sin(end.theta), 0);
		} else {
			ret = Position(data[index][0], data[index][1], data[index][2]);
		}
		if (mirror)
			return ret.mirror_x();
		return ret;
	}
};

class C90: public Trajectory {
public:
	C90(bool mirror = false) :
			Trajectory(), mirror(mirror) {
	}
private:
	bool mirror;
	virtual int size() const {
		return 154;
	}
	virtual Position position(int index) const {
		static const float data[155][3] =
				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000069, 0.00000275 }, { 2.00000000, 0.00001120, 0.00002229 }, { 3.00000000, 0.00005690, 0.00007559 }, { 3.99999999, 0.00018005, 0.00017952 }, { 4.99999996, 0.00043979, 0.00035089 }, { 5.99999984, 0.00091200, 0.00060639 }, { 6.99999953, 0.00168919, 0.00096257 }, { 7.99999882, 0.00288031, 0.00143582 }, { 8.99999730, 0.00461064, 0.00204232 }, { 9.99999437, 0.00702150, 0.00279804 }, { 10.99998906, 0.01027009, 0.00371871 }, { 11.99997994, 0.01452915, 0.00481976 }, { 12.99996498, 0.01998674, 0.00611635 }, { 13.99994136, 0.02684590, 0.00762328 }, { 14.99990529, 0.03532429, 0.00935503 }, { 15.99985178, 0.04565384, 0.01132570 }, { 16.99977436, 0.05808035, 0.01354897 }, { 17.99966483, 0.07286311, 0.01603813 }, { 18.99951292, 0.09027438, 0.01880601 }, { 19.99930597, 0.11059900, 0.02186497 }, { 20.99902851, 0.13413385, 0.02522692 }, { 21.99866194, 0.16118732, 0.02890322 }, { 22.99818401, 0.19207883, 0.03290473 }, { 23.99756846, 0.22713818, 0.03724178 }, { 24.99678447, 0.26670501, 0.04192411 }, { 25.99579622, 0.31112814, 0.04696092 }, { 26.99456233, 0.36076493, 0.05236079 }, { 27.99303539, 0.41598064, 0.05813172 }, { 28.99116136, 0.47714766, 0.06428108 }, { 29.98887904, 0.54464485, 0.07081561 }, { 30.98611953, 0.61885671, 0.07774141 }, { 31.98280566, 0.70017266, 0.08506393 }, { 32.97885144, 0.78898618, 0.09278795 }, { 33.97416148, 0.88569401, 0.10091761 }, { 34.96863052, 0.99069524, 0.10945634 }, { 35.96214284, 1.10439044, 0.11840691 }, { 36.95457179, 1.22718074, 0.12777141 }, { 37.94577934, 1.35946688, 0.13755121 }, { 38.93561559, 1.50164822, 0.14774703 }, { 39.92391839, 1.65412180, 0.15835886 }, { 40.91051296, 1.81728125, 0.16938602 }, { 41.89521160, 1.99151583, 0.18082714 }, { 42.87781335, 2.17720933, 0.19268015 }, { 43.85810387, 2.37473902, 0.20494230 }, { 44.83585518, 2.58447456, 0.21761015 }, { 45.81082564, 2.80677696, 0.23067960 }, { 46.78275991, 3.04199742, 0.24414587 }, { 47.75138896, 3.29047629, 0.25800352 }, { 48.71643024, 3.55254199, 0.27224648 }, { 49.67758783, 3.82850987, 0.28686800 }, { 50.63455274, 4.11868122, 0.30186074 }, { 51.58700330, 4.42334217, 0.31721670 }, { 52.53460551, 4.74276269, 0.33292732 }, { 53.47701367, 5.07719562, 0.34898341 }, { 54.41387090, 5.42687565, 0.36537524 }, { 55.34480991, 5.79201847, 0.38209249 }, { 56.26945369, 6.17281987, 0.39912432 }, { 57.18741642, 6.56945493, 0.41645936 }, { 58.09830439, 6.98207729, 0.43408573 }, { 59.00171699, 7.41081841, 0.45199108 }, { 59.89724779, 7.85578703, 0.47016257 }, { 60.78448569, 8.31706854, 0.48858694 }, { 61.66301609, 8.79472459, 0.50725050 }, { 62.53242219, 9.28879271, 0.52613916 }, { 63.39228625, 9.79928598, 0.54523847 }, { 64.24219100, 10.32619291, 0.56453360 }, { 65.08172091, 10.86947728, 0.58400943 }, { 65.91046372, 11.42907822, 0.60365051 }, { 66.72801178, 12.00491025, 0.62344113 }, { 67.53396351, 12.59686357, 0.64336533 }, { 68.32792484, 13.20480430, 0.66340692 }, { 69.10951063, 13.82857497, 0.68354952 }, { 69.87834609, 14.46799497, 0.70377658 }, { 70.63406816, 15.12286124, 0.72407142 }, { 71.37632686, 15.79294895, 0.74441723 }, { 72.10478659, 16.47801231, 0.76479713 }, { 72.81912743, 17.17778548, 0.78519416 }, { 73.51904630, 17.89198357, 0.80559137 }, { 74.20425810, 18.62030368, 0.82597177 }, { 74.87449682, 19.36242602, 0.84631843 }, { 75.52951645, 20.11801516, 0.86661445 }, { 76.16909196, 20.88672127, 0.88684304 }, { 76.79302005, 21.66818139, 0.90698749 }, { 77.40111990, 22.46202086, 0.92703126 }, { 77.99323379, 23.26785462, 0.94695797 }, { 78.56922763, 24.08528869, 0.96675142 }, { 79.12899134, 24.91392156, 0.98639564 }, { 79.67243922, 25.75334564, 1.00587493 }, { 80.19951014, 26.60314869, 1.02517383 }, { 80.71016765, 27.46291523, 1.04427720 }, { 81.20439999, 28.33222797, 1.06317022 }, { 81.68222002, 29.21066920, 1.08183842 }, { 82.14366501, 30.09782207, 1.10026771 }, { 82.58879637, 30.99327198, 1.11844438 }, { 83.01769927, 31.89660779, 1.13635518 }, { 83.43048220, 32.80742300, 1.15398725 }, { 83.82727642, 33.72531695, 1.17132824 }, { 84.20823532, 34.64989584, 1.18836624 }, { 84.57353379, 35.58077377, 1.20508990 }, { 84.92336741, 36.51757366, 1.22148834 }, { 85.25795168, 37.45992810, 1.23755124 }, { 85.57752111, 38.40748010, 1.25326886 }, { 85.88232834, 39.35988384, 1.26863200 }, { 86.17264320, 40.31680523, 1.28363208 }, { 86.44875165, 41.27792244, 1.29826110 }, { 86.71095482, 42.24292637, 1.31251170 }, { 86.95956796, 43.21152096, 1.32637712 }, { 87.19491934, 44.18342353, 1.33985128 }, { 87.41734919, 45.15836492, 1.35292871 }, { 87.62720864, 46.13608964, 1.36560464 }, { 87.82485856, 47.11635591, 1.37787493 }, { 88.01066857, 48.09893564, 1.38973615 }, { 88.18501585, 49.08361433, 1.40118553 }, { 88.34828414, 50.07019089, 1.41222099 }, { 88.50086263, 51.05847749, 1.42284114 }, { 88.64314494, 52.04829923, 1.43304528 }, { 88.77552805, 53.03949383, 1.44283340 }, { 88.89841133, 54.03191127, 1.45220618 }, { 89.01219549, 55.02541340, 1.46116502 }, { 89.11728168, 56.01987346, 1.46971196 }, { 89.21407046, 57.01517564, 1.47784977 }, { 89.30296096, 58.01121454, 1.48558187 }, { 89.38434993, 59.00789471, 1.49291237 }, { 89.45863090, 60.00513005, 1.49984605 }, { 89.52619332, 61.00284332, 1.50638835 }, { 89.58742176, 62.00096552, 1.51254535 }, { 89.64269512, 62.99943538, 1.51832378 }, { 89.69238589, 63.99819881, 1.52373100 }, { 89.73685937, 64.99720832, 1.52877498 }, { 89.77647302, 65.99642247, 1.53346432 }, { 89.81157575, 66.99580540, 1.53780818 }, { 89.84250728, 67.99532623, 1.54181630 }, { 89.86959754, 68.99495866, 1.54549900 }, { 89.89316603, 69.99468041, 1.54886712 }, { 89.91352126, 70.99447283, 1.55193203 }, { 89.93096024, 71.99432044, 1.55470562 }, { 89.94576791, 72.99421054, 1.55720022 }, { 89.95821668, 73.99413285, 1.55942869 }, { 89.96856596, 74.99407913, 1.56140427 }, { 89.97706168, 75.99404292, 1.56314066 }, { 89.98393593, 76.99401919, 1.56465195 }, { 89.98940652, 77.99400416, 1.56595260 }, { 89.99367661, 78.99399499, 1.56705741 }, { 89.99693442, 79.99398965, 1.56798154 }, { 89.99935285, 80.99398670, 1.56874041 }, { 90.00108926, 81.99398518, 1.56934974 }, { 90.00228513, 82.99398445, 1.56982550 }, { 90.00306589, 83.99398414, 1.57018386 }, { 90.00354066, 84.99398403, 1.57044121 }, { 90.00380213, 85.99398399, 1.57061410 }, { 90.00392632, 86.99398398, 1.57071921 }, { 90.00397255, 87.99398398, 1.57077335 }, { 90.00398326, 88.99398398, 1.57079341 }, { 90.00000000, 90.00000000, 1.57079633 }, };
		Position ret;
		if (index < 0) {
			ret = Position(0 + interval * index, 0, 0);
		} else if (index > size() - 1) {
			Position end(data[size()][0], data[size()][1], data[size()][2]);
			ret = end
					+ Position((index - size()) * interval * cos(end.theta),
							(index - size()) * interval * sin(end.theta), 0);
		} else {
			ret = Position(data[index][0], data[index][1], data[index][2]);
		}
		if (mirror)
			return ret.mirror_x();
		return ret;
	}
};

class C135: public Trajectory {
public:
	C135(bool mirror = false) :
			Trajectory(), mirror(mirror) {
	}
private:
	bool mirror;
	virtual int size() const {
		return 218;
	}
	virtual Position position(int index) const {
		static const float data[219][3] =
				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000036, 0.00000144 }, { 2.00000000, 0.00000586, 0.00001166 }, { 3.00000000, 0.00002976, 0.00003954 }, { 4.00000000, 0.00009419, 0.00009394 }, { 4.99999999, 0.00023014, 0.00018368 }, { 5.99999996, 0.00047739, 0.00031757 }, { 6.99999987, 0.00088453, 0.00050438 }, { 7.99999967, 0.00150888, 0.00075284 }, { 8.99999926, 0.00241648, 0.00107161 }, { 9.99999845, 0.00368199, 0.00146931 }, { 10.99999699, 0.00538868, 0.00195450 }, { 11.99999446, 0.00762830, 0.00253564 }, { 12.99999032, 0.01050108, 0.00322114 }, { 13.99998376, 0.01411556, 0.00401932 }, { 14.99997372, 0.01858858, 0.00493839 }, { 15.99995879, 0.02404514, 0.00598647 }, { 16.99993712, 0.03061830, 0.00717158 }, { 17.99990639, 0.03844906, 0.00850162 }, { 18.99986363, 0.04768629, 0.00998436 }, { 19.99980520, 0.05848653, 0.01162747 }, { 20.99972659, 0.07101393, 0.01343847 }, { 21.99962236, 0.08544006, 0.01542475 }, { 22.99948597, 0.10194379, 0.01759354 }, { 23.99930962, 0.12071112, 0.01995193 }, { 24.99908409, 0.14193503, 0.02250686 }, { 25.99879860, 0.16581531, 0.02526510 }, { 26.99844057, 0.19255837, 0.02823326 }, { 27.99799547, 0.22237708, 0.03141776 }, { 28.99744659, 0.25549055, 0.03482486 }, { 29.99677481, 0.29212396, 0.03846063 }, { 30.99595840, 0.33250830, 0.04233094 }, { 31.99497278, 0.37688021, 0.04644149 }, { 32.99379024, 0.42548172, 0.05079776 }, { 33.99237970, 0.47856002, 0.05540504 }, { 34.99070648, 0.53636721, 0.06026841 }, { 35.98873197, 0.59916006, 0.06539274 }, { 36.98641337, 0.66719971, 0.07078268 }, { 37.98370344, 0.74075142, 0.07644266 }, { 38.98055014, 0.82008429, 0.08237691 }, { 39.97689642, 0.90547092, 0.08858939 }, { 40.97267984, 0.99718715, 0.09508388 }, { 41.96783232, 1.09551169, 0.10186389 }, { 42.96227981, 1.20072582, 0.10893270 }, { 43.95594203, 1.31311302, 0.11629338 }, { 44.94873211, 1.43295864, 0.12394873 }, { 45.94055634, 1.56054947, 0.13190132 }, { 46.93131386, 1.69617342, 0.14015346 }, { 47.92089638, 1.84011909, 0.14870723 }, { 48.90918786, 1.99267533, 0.15756447 }, { 49.89606430, 2.15413086, 0.16672673 }, { 50.88139344, 2.32477382, 0.17619535 }, { 51.86503450, 2.50489130, 0.18597141 }, { 52.84683795, 2.69476887, 0.19605571 }, { 53.82664533, 2.89469013, 0.20644882 }, { 54.80428894, 3.10493620, 0.21715104 }, { 55.77959177, 3.32578522, 0.22816245 }, { 56.75236723, 3.55751184, 0.23948282 }, { 57.72241906, 3.80038667, 0.25111172 }, { 58.68954116, 4.05467578, 0.26304842 }, { 59.65351755, 4.32064014, 0.27529197 }, { 60.61412220, 4.59853504, 0.28784115 }, { 61.57111906, 4.88860957, 0.30069448 }, { 62.52426200, 5.19110604, 0.31385026 }, { 63.47329482, 5.50625937, 0.32730651 }, { 64.41795128, 5.83429656, 0.34106102 }, { 65.35795520, 6.17543610, 0.35511131 }, { 66.29302051, 6.52988738, 0.36945470 }, { 67.22285147, 6.89785008, 0.38408823 }, { 68.14714274, 7.27951367, 0.39900870 }, { 69.06557966, 7.67505677, 0.41421271 }, { 69.97783849, 8.08464662, 0.42969659 }, { 70.88358666, 8.50843850, 0.44545645 }, { 71.78248310, 8.94657520, 0.46148818 }, { 72.67417861, 9.39918649, 0.47778744 }, { 73.55831624, 9.86638858, 0.49434966 }, { 74.43453172, 10.34828365, 0.51117008 }, { 75.30245393, 10.84495933, 0.52824370 }, { 76.16170542, 11.35648829, 0.54556531 }, { 77.01190291, 11.88292776, 0.56312953 }, { 77.85265790, 12.42431915, 0.58093074 }, { 78.68357726, 12.98068767, 0.59896315 }, { 79.50426387, 13.55204195, 0.61722076 }, { 80.31431728, 14.13837379, 0.63569740 }, { 81.11333443, 14.73965781, 0.65438673 }, { 81.90091037, 15.35585128, 0.67328219 }, { 82.67663899, 15.98689384, 0.69237710 }, { 83.44011382, 16.63270743, 0.71166459 }, { 84.19092878, 17.29319611, 0.73113763 }, { 84.92867906, 17.96824599, 0.75078906 }, { 85.65296187, 18.65772527, 0.77061153 }, { 86.36337732, 19.36148417, 0.79059759 }, { 87.05952928, 20.07935509, 0.81073964 }, { 87.74102617, 20.81115265, 0.83102995 }, { 88.40748190, 21.55667393, 0.85146067 }, { 89.05851664, 22.31569865, 0.87202383 }, { 89.69375774, 23.08798946, 0.89271135 }, { 90.31284052, 23.87329223, 0.91351506 }, { 90.91540915, 24.67133647, 0.93442669 }, { 91.50111744, 25.48183570, 0.95543786 }, { 92.06962964, 26.30448798, 0.97654014 }, { 92.62062124, 27.13897637, 0.99772500 }, { 93.15377971, 27.98496950, 1.01898386 }, { 93.66880525, 28.84212223, 1.04030806 }, { 94.16541148, 29.71007624, 1.06168890 }, { 94.64332611, 30.58846075, 1.08311764 }, { 95.10229155, 31.47689326, 1.10458548 }, { 95.54206556, 32.37498028, 1.12608360 }, { 95.96242174, 33.28231820, 1.14760315 }, { 96.36315010, 34.19849403, 1.16913527 }, { 96.74405746, 35.12308634, 1.19067109 }, { 97.10496794, 36.05566609, 1.21220172 }, { 97.44572328, 36.99579758, 1.23371830 }, { 97.76618317, 37.94303935, 1.25521196 }, { 98.06622553, 38.89694511, 1.27667385 }, { 98.34574673, 39.85706472, 1.29809517 }, { 98.60466175, 40.82294513, 1.31946712 }, { 98.84290427, 41.79413133, 1.34078097 }, { 99.06042678, 42.77016737, 1.36202802 }, { 99.25720054, 43.75059724, 1.38319963 }, { 99.43321557, 44.73496590, 1.40428722 }, { 99.58848052, 45.72282018, 1.42528228 }, { 99.72302257, 46.71370971, 1.44617639 }, { 99.83688717, 47.70718787, 1.46696119 }, { 99.93013788, 48.70281266, 1.48762842 }, { 100.00285599, 49.70014757, 1.50816993 }, { 100.05514025, 50.69876243, 1.52857765 }, { 100.08710648, 51.69823426, 1.54884364 }, { 100.09888712, 52.69814801, 1.56896006 }, { 100.09063082, 53.69809733, 1.58891921 }, { 100.06250194, 54.69768531, 1.60871351 }, { 100.01467999, 55.69652512, 1.62833552 }, { 99.94735912, 56.69424072, 1.64777794 }, { 99.86074753, 57.69046737, 1.66703362 }, { 99.75506685, 58.68485226, 1.68609555 }, { 99.63055151, 59.67705501, 1.70495691 }, { 99.48744815, 60.66674811, 1.72361101 }, { 99.32601486, 61.65361739, 1.74205136 }, { 99.14652059, 62.63736235, 1.76027163 }, { 98.94924445, 63.61769655, 1.77826567 }, { 98.73447499, 64.59434787, 1.79602753 }, { 98.50250951, 65.56705873, 1.81355144 }, { 98.25365339, 66.53558636, 1.83083184 }, { 97.98821938, 67.49970285, 1.84786334 }, { 97.70652690, 68.45919537, 1.86464080 }, { 97.40890134, 69.41386615, 1.88115925 }, { 97.09567344, 70.36353255, 1.89741395 }, { 96.76717854, 71.30802702, 1.91340038 }, { 96.42375599, 72.24719707, 1.92911423 }, { 96.06574847, 73.18090514, 1.94455143 }, { 95.69350138, 74.10902850, 1.95970814 }, { 95.30736224, 75.03145906, 1.97458072 }, { 94.90768007, 75.94810318, 1.98916580 }, { 94.49480487, 76.85888144, 2.00346023 }, { 94.06908701, 77.76372838, 2.01746110 }, { 93.63087677, 78.66259218, 2.03116574 }, { 93.18052378, 79.55543439, 2.04457175 }, { 92.71837658, 80.44222955, 2.05767693 }, { 92.24478214, 81.32296484, 2.07047936 }, { 91.76008546, 82.19763971, 2.08297738 }, { 91.26462913, 83.06626543, 2.09516954 }, { 90.75875297, 83.92886472, 2.10705468 }, { 90.24279366, 84.78547129, 2.11863187 }, { 89.71708442, 85.63612940, 2.12990045 }, { 89.18195470, 86.48089338, 2.14086001 }, { 88.63772990, 87.31982718, 2.15151038 }, { 88.08473109, 88.15300387, 2.16185167 }, { 87.52327477, 88.98050518, 2.17188422 }, { 86.95367269, 89.80242099, 2.18160865 }, { 86.37623161, 90.61884883, 2.19102581 }, { 85.79125315, 91.42989339, 2.20013681 }, { 85.19903362, 92.23566604, 2.20894303 }, { 84.59986388, 93.03628431, 2.21744608 }, { 83.99402925, 93.83187138, 2.22564783 }, { 83.38180934, 94.62255563, 2.23355039 }, { 82.76347802, 95.40847010, 2.24115614 }, { 82.13930332, 96.18975206, 2.24846766 }, { 81.50954736, 96.96654246, 2.25548782 }, { 80.87446632, 97.73898553, 2.26221970 }, { 80.23431038, 98.50722827, 2.26866664 }, { 79.58932368, 99.27142000, 2.27483219 }, { 78.93974435, 100.03171192, 2.28072015 }, { 78.28580441, 100.78825665, 2.28633454 }, { 77.62772986, 101.54120785, 2.29167962 }, { 76.96574060, 102.29071973, 2.29675985 }, { 76.30005046, 103.03694671, 2.30157992 }, { 75.63086722, 103.78004298, 2.30614475 }, { 74.95839261, 104.52016212, 2.31045943 }, { 74.28282231, 105.25745677, 2.31452930 }, { 73.60434599, 105.99207821, 2.31835987 }, { 72.92314728, 106.72417605, 2.32195687 }, { 72.23940385, 107.45389789, 2.32532620 }, { 71.55328735, 108.18138901, 2.32847398 }, { 70.86496348, 108.90679202, 2.33140647 }, { 70.17459198, 109.63024663, 2.33413015 }, { 69.48232664, 110.35188932, 2.33665164 }, { 68.78831531, 111.07185309, 2.33897775 }, { 68.09269990, 111.79026719, 2.34111542 }, { 67.39561640, 112.50725692, 2.34307179 }, { 66.69719485, 113.22294336, 2.34485411 }, { 65.99755939, 113.93744318, 2.34646980 }, { 65.29682818, 114.65086844, 2.34792640 }, { 64.59511346, 115.36332638, 2.34923158 }, { 63.89252152, 116.07491927, 2.35039315 }, { 63.18915266, 116.78574425, 2.35141903 }, { 62.48510119, 117.49589316, 2.35231726 }, { 61.78045545, 118.20545240, 2.35309596 }, { 61.07529771, 118.91450284, 2.35376338 }, { 60.36970423, 119.62311967, 2.35432784 }, { 59.66374518, 120.33137232, 2.35479776 }, { 58.95748466, 121.03932434, 2.35518162 }, { 58.25098062, 121.74703335, 2.35548800 }, { 57.54428492, 122.45455096, 2.35572550 }, { 56.83744320, 123.16192271, 2.35590283 }, { 56.13049495, 123.86918798, 2.35602871 }, { 55.42347344, 124.57638002, 2.35611190 }, { 54.71640570, 125.28352585, 2.35616123 }, { 54.00931255, 125.99064625, 2.35618554 }, { 52.72238106, 127.27758345, 2.35619449 }, };
		Position ret;
		if (index < 0) {
			ret = Position(0 + interval * index, 0, 0);
		} else if (index > size() - 1) {
			Position end(data[size()][0], data[size()][1], data[size()][2]);
			ret = end
					+ Position((index - size()) * interval * cos(end.theta),
							(index - size()) * interval * sin(end.theta), 0);
		} else {
			ret = Position(data[index][0], data[index][1], data[index][2]);
		}
		if (mirror)
			return ret.mirror_x();
		return ret;
	}
};

class C180: public Trajectory {
public:
	C180(bool mirror = false) :
			Trajectory(), mirror(mirror) {
	}
private:
	bool mirror;
	virtual int size() const {
		return 463;
	}
	virtual Position position(int index) const {
		static const float data[464][3] =
				{ { 0.00000000, 0.00000000, 0.00000000 }, { 1.00000000, 0.00000005, 0.00000020 }, { 2.00000000, 0.00000082, 0.00000164 }, { 3.00000000, 0.00000418, 0.00000556 }, { 4.00000000, 0.00001325, 0.00001321 }, { 5.00000000, 0.00003237, 0.00002585 }, { 6.00000000, 0.00006717, 0.00004470 }, { 7.00000000, 0.00012450, 0.00007103 }, { 7.99999999, 0.00021244, 0.00010607 }, { 8.99999999, 0.00034035, 0.00015106 }, { 9.99999997, 0.00051880, 0.00020725 }, { 10.99999994, 0.00075961, 0.00027587 }, { 11.99999989, 0.00107585, 0.00035816 }, { 12.99999981, 0.00148179, 0.00045535 }, { 13.99999968, 0.00199298, 0.00056867 }, { 14.99999947, 0.00262615, 0.00069936 }, { 15.99999917, 0.00339929, 0.00084863 }, { 16.99999874, 0.00433160, 0.00101770 }, { 17.99999812, 0.00544349, 0.00120779 }, { 18.99999726, 0.00675661, 0.00142012 }, { 19.99999607, 0.00829380, 0.00165590 }, { 20.99999448, 0.01007911, 0.00191633 }, { 21.99999235, 0.01213779, 0.00220260 }, { 22.99998957, 0.01449632, 0.00251592 }, { 23.99998595, 0.01718232, 0.00285748 }, { 24.99998132, 0.02022464, 0.00322846 }, { 25.99997544, 0.02365330, 0.00363004 }, { 26.99996803, 0.02749948, 0.00406340 }, { 27.99995880, 0.03179556, 0.00452971 }, { 28.99994736, 0.03657507, 0.00503012 }, { 29.99993332, 0.04187269, 0.00556579 }, { 30.99991618, 0.04772427, 0.00613788 }, { 31.99989542, 0.05416681, 0.00674753 }, { 32.99987039, 0.06123842, 0.00739587 }, { 33.99984042, 0.06897837, 0.00808403 }, { 34.99980471, 0.07742704, 0.00881314 }, { 35.99976237, 0.08662594, 0.00958430 }, { 36.99971243, 0.09661767, 0.01039863 }, { 37.99965377, 0.10744594, 0.01125722 }, { 38.99958517, 0.11915556, 0.01216116 }, { 39.99950529, 0.13179241, 0.01311154 }, { 40.99941261, 0.14540347, 0.01410943 }, { 41.99930549, 0.16003674, 0.01515589 }, { 42.99918212, 0.17574134, 0.01625198 }, { 43.99904050, 0.19256737, 0.01739875 }, { 44.99887845, 0.21056603, 0.01859723 }, { 45.99869359, 0.22978950, 0.01984845 }, { 46.99848335, 0.25029099, 0.02115342 }, { 47.99824488, 0.27212475, 0.02251317 }, { 48.99797515, 0.29534597, 0.02392868 }, { 49.99767084, 0.32001087, 0.02540094 }, { 50.99732836, 0.34617662, 0.02693094 }, { 51.99694385, 0.37390136, 0.02851963 }, { 52.99651314, 0.40324418, 0.03016797 }, { 53.99603175, 0.43426510, 0.03187692 }, { 54.99549487, 0.46702507, 0.03364739 }, { 55.99489732, 0.50158595, 0.03548032 }, { 56.99423358, 0.53801052, 0.03737661 }, { 57.99349772, 0.57636241, 0.03933717 }, { 58.99268340, 0.61670614, 0.04136288 }, { 59.99178390, 0.65910709, 0.04345462 }, { 60.99079200, 0.70363148, 0.04561326 }, { 61.98970006, 0.75034636, 0.04783963 }, { 62.98849993, 0.79931959, 0.05013458 }, { 63.98718297, 0.85061982, 0.05249895 }, { 64.98574002, 0.90431649, 0.05493353 }, { 65.98416135, 0.96047981, 0.05743913 }, { 66.98243669, 1.01918074, 0.06001654 }, { 67.98055515, 1.08049095, 0.06266653 }, { 68.97850526, 1.14448285, 0.06538987 }, { 69.97627489, 1.21122954, 0.06818729 }, { 70.97385125, 1.28080477, 0.07105954 }, { 71.97122088, 1.35328299, 0.07400733 }, { 72.96836961, 1.42873926, 0.07703137 }, { 73.96528254, 1.50724927, 0.08013235 }, { 74.96194399, 1.58888932, 0.08331095 }, { 75.95833755, 1.67373627, 0.08656783 }, { 76.95444595, 1.76186755, 0.08990364 }, { 77.95025113, 1.85336111, 0.09331901 }, { 78.94573415, 1.94829544, 0.09681457 }, { 79.94087522, 2.04674951, 0.10039092 }, { 80.93565359, 2.14880274, 0.10404865 }, { 81.93004764, 2.25453501, 0.10778833 }, { 82.92403475, 2.36402663, 0.11161053 }, { 83.91759132, 2.47735828, 0.11551579 }, { 84.91069276, 2.59461104, 0.11950464 }, { 85.90331342, 2.71586629, 0.12357760 }, { 86.89542661, 2.84120577, 0.12773515 }, { 87.88700453, 2.97071148, 0.13197779 }, { 88.87801828, 3.10446570, 0.13630599 }, { 89.86843781, 3.24255094, 0.14072019 }, { 90.85823191, 3.38504989, 0.14522083 }, { 91.84736817, 3.53204544, 0.14980834 }, { 92.83581298, 3.68362062, 0.15448311 }, { 93.82353147, 3.83985856, 0.15924553 }, { 94.81048751, 4.00084248, 0.16409598 }, { 95.79664366, 4.16665565, 0.16903481 }, { 96.78196119, 4.33738135, 0.17406236 }, { 97.76640000, 4.51310284, 0.17917895 }, { 98.74991865, 4.69390333, 0.18438490 }, { 99.73247428, 4.87986593, 0.18968048 }, { 100.71402265, 5.07107365, 0.19506598 }, { 101.69451805, 5.26760931, 0.20054165 }, { 102.67391333, 5.46955557, 0.20610773 }, { 103.65215988, 5.67699481, 0.21176445 }, { 104.62920754, 5.89000916, 0.21751201 }, { 105.60500466, 6.10868044, 0.22335061 }, { 106.57949805, 6.33309011, 0.22928041 }, { 107.55263295, 6.56331923, 0.23530158 }, { 108.52435302, 6.79944844, 0.24141425 }, { 109.49460031, 7.04155787, 0.24761855 }, { 110.46331528, 7.28972718, 0.25391459 }, { 111.43043674, 7.54403541, 0.26030245 }, { 112.39590186, 7.80456104, 0.26678221 }, { 113.35964615, 8.07138188, 0.27335392 }, { 114.32160342, 8.34457503, 0.28001762 }, { 115.28170583, 8.62421686, 0.28677334 }, { 116.23988382, 8.91038295, 0.29362108 }, { 117.19606612, 9.20314805, 0.30056082 }, { 118.15017973, 9.50258601, 0.30759254 }, { 119.10214995, 9.80876976, 0.31471620 }, { 120.05190030, 10.12177124, 0.32193172 }, { 120.99935260, 10.44166136, 0.32923904 }, { 121.94442689, 10.76850997, 0.33663804 }, { 122.88704149, 11.10238577, 0.34412863 }, { 123.82711293, 11.44335628, 0.35171067 }, { 124.76455602, 11.79148780, 0.35938402 }, { 125.69928379, 12.14684533, 0.36714850 }, { 126.63120752, 12.50949255, 0.37500394 }, { 127.56023676, 12.87949176, 0.38295014 }, { 128.48627929, 13.25690381, 0.39098689 }, { 129.40924116, 13.64178804, 0.39911396 }, { 130.32902670, 14.03420229, 0.40733109 }, { 131.24553849, 14.43420278, 0.41563803 }, { 132.15867742, 14.84184406, 0.42403450 }, { 133.06834268, 15.25717901, 0.43252019 }, { 133.97443175, 15.68025874, 0.44109480 }, { 134.87684048, 16.11113255, 0.44975800 }, { 135.77546303, 16.54984787, 0.45850943 }, { 136.67019193, 16.99645023, 0.46734874 }, { 137.56091813, 17.45098319, 0.47627555 }, { 138.44753094, 17.91348828, 0.48528946 }, { 139.32991813, 18.38400494, 0.49439006 }, { 140.20796594, 18.86257053, 0.50357693 }, { 141.08155907, 19.34922017, 0.51284963 }, { 141.95058074, 19.84398681, 0.52220769 }, { 142.81491274, 20.34690109, 0.53165065 }, { 143.67443542, 20.85799130, 0.54117800 }, { 144.52902774, 21.37728338, 0.55078926 }, { 145.37856733, 21.90480083, 0.56048389 }, { 146.22293049, 22.44056466, 0.57026136 }, { 147.06199227, 22.98459336, 0.58012113 }, { 147.89562648, 23.53690284, 0.59006261 }, { 148.72370576, 24.09750639, 0.60008524 }, { 149.54610159, 24.66641463, 0.61018842 }, { 150.36268439, 25.24363548, 0.62037153 }, { 151.17332350, 25.82917407, 0.63063395 }, { 151.97788731, 26.42303278, 0.64097505 }, { 152.77624326, 27.02521111, 0.65139415 }, { 153.56825789, 27.63570570, 0.66189060 }, { 154.35379693, 28.25451026, 0.67246372 }, { 155.13272536, 28.88161557, 0.68311280 }, { 155.90490741, 29.51700937, 0.69383713 }, { 156.67020671, 30.16067643, 0.70463599 }, { 157.42848626, 30.81259841, 0.71550864 }, { 158.17960857, 31.47275391, 0.72645432 }, { 158.92343570, 32.14111840, 0.73747227 }, { 159.65982930, 32.81766420, 0.74856172 }, { 160.38865072, 33.50236045, 0.75972186 }, { 161.10976105, 34.19517311, 0.77095190 }, { 161.82302123, 34.89606489, 0.78225101 }, { 162.52829206, 35.60499526, 0.79361836 }, { 163.22543435, 36.32192046, 0.80505311 }, { 163.91430892, 37.04679342, 0.81655441 }, { 164.59477673, 37.77956378, 0.82812138 }, { 165.26669895, 38.52017789, 0.83975314 }, { 165.92993702, 39.26857877, 0.85144881 }, { 166.58435272, 40.02470611, 0.86320747 }, { 167.22980829, 40.78849631, 0.87502822 }, { 167.86616649, 41.55988238, 0.88691012 }, { 168.49329066, 42.33879405, 0.89885224 }, { 169.11104485, 43.12515768, 0.91085363 }, { 169.71929385, 43.91889633, 0.92291332 }, { 170.31790332, 44.71992971, 0.93503035 }, { 170.90673983, 45.52817423, 0.94720373 }, { 171.48567099, 46.34354301, 0.95943248 }, { 172.05456549, 47.16594588, 0.97171559 }, { 172.61329323, 47.99528937, 0.98405204 }, { 173.16172536, 48.83147680, 0.99644082 }, { 173.69973439, 49.67440822, 1.00888089 }, { 174.22719427, 50.52398051, 1.02137122 }, { 174.74398047, 51.38008735, 1.03391075 }, { 175.24997008, 52.24261927, 1.04649842 }, { 175.74504186, 53.11146370, 1.05913317 }, { 176.22907635, 53.98650496, 1.07181392 }, { 176.70195597, 54.86762434, 1.08453958 }, { 177.16356504, 55.75470014, 1.09730905 }, { 177.61378993, 56.64760768, 1.11012125 }, { 178.05251909, 57.54621937, 1.12297505 }, { 178.47964316, 58.45040473, 1.13586934 }, { 178.89505502, 59.36003051, 1.14880300 }, { 179.29864991, 60.27496064, 1.16177489 }, { 179.69032546, 61.19505637, 1.17478388 }, { 180.06998180, 62.12017630, 1.18782882 }, { 180.43752160, 63.05017643, 1.20090855 }, { 180.79285017, 63.98491023, 1.21402192 }, { 181.13587552, 64.92422871, 1.22716776 }, { 181.46650844, 65.86798048, 1.24034491 }, { 181.78466253, 66.81601183, 1.25355218 }, { 182.09025431, 67.76816679, 1.26678839 }, { 182.38320326, 68.72428721, 1.28005236 }, { 182.66343188, 69.68421283, 1.29334289 }, { 182.93086575, 70.64778138, 1.30665879 }, { 183.18543362, 71.61482862, 1.31999884 }, { 183.42706740, 72.58518847, 1.33336186 }, { 183.65570227, 73.55869305, 1.34674662 }, { 183.87127669, 74.53517280, 1.36015190 }, { 184.07373249, 75.51445653, 1.37357650 }, { 184.26301488, 76.49637156, 1.38701919 }, { 184.43907250, 77.48074376, 1.40047874 }, { 184.60185747, 78.46739766, 1.41395393 }, { 184.75132542, 79.45615656, 1.42744352 }, { 184.88743554, 80.44684261, 1.44094627 }, { 185.01015058, 81.43927689, 1.45446096 }, { 185.11943691, 82.43327953, 1.46798634 }, { 185.21526453, 83.42866981, 1.48152118 }, { 185.29760711, 84.42526622, 1.49506422 }, { 185.36644199, 85.42288662, 1.50861423 }, { 185.42175021, 86.42134828, 1.52216996 }, { 185.46351652, 87.42046802, 1.53573016 }, { 185.49172941, 88.42006229, 1.54929359 }, { 185.50638110, 89.41994728, 1.56285900 }, { 185.50746753, 90.41993903, 1.57642513 }, { 185.49498841, 91.41985349, 1.58999075 }, { 185.46894718, 92.41950669, 1.60355461 }, { 185.42935103, 93.41871479, 1.61711545 }, { 185.37621088, 94.41729419, 1.63067203 }, { 185.30954138, 95.41506163, 1.64422310 }, { 185.22936089, 96.41183433, 1.65776741 }, { 185.13569148, 97.40743002, 1.67130373 }, { 185.02855890, 98.40166709, 1.68483081 }, { 184.90799256, 99.39436470, 1.69834740 }, { 184.77402551, 100.38534282, 1.71185228 }, { 184.62669442, 101.37442238, 1.72534420 }, { 184.46603954, 102.36142535, 1.73882192 }, { 184.29210466, 103.34617484, 1.75228422 }, { 184.10493711, 104.32849518, 1.76572986 }, { 183.90458769, 105.30821202, 1.77915762 }, { 183.69111064, 106.28515243, 1.79256628 }, { 183.46456361, 107.25914499, 1.80595462 }, { 183.22500758, 108.23001987, 1.81932142 }, { 182.97250686, 109.19760891, 1.83266547 }, { 182.70712901, 110.16174573, 1.84598556 }, { 182.42894479, 111.12226580, 1.85928049 }, { 182.13802812, 112.07900653, 1.87254907 }, { 181.83445600, 113.03180733, 1.88579009 }, { 181.51830846, 113.98050970, 1.89900237 }, { 181.18966854, 114.92495733, 1.91218472 }, { 180.84862214, 115.86499613, 1.92533597 }, { 180.49525805, 116.80047434, 1.93845495 }, { 180.12966782, 117.73124257, 1.95154049 }, { 179.75194570, 118.65715392, 1.96459143 }, { 179.36218861, 119.57806395, 1.97760662 }, { 178.96049601, 120.49383085, 1.99058490 }, { 178.54696988, 121.40431544, 2.00352515 }, { 178.12171460, 122.30938123, 2.01642622 }, { 177.68483693, 123.20889450, 2.02928699 }, { 177.23644586, 124.10272432, 2.04210634 }, { 176.77665259, 124.99074265, 2.05488317 }, { 176.30557044, 125.87282434, 2.06761636 }, { 175.82331475, 126.74884719, 2.08030483 }, { 175.33000282, 127.61869201, 2.09294748 }, { 174.82575381, 128.48224265, 2.10554324 }, { 174.31068866, 129.33938604, 2.11809103 }, { 173.78493005, 130.19001219, 2.13058981 }, { 173.24860223, 131.03401430, 2.14303851 }, { 172.70183102, 131.87128872, 2.15543609 }, { 172.14474369, 132.70173499, 2.16778152 }, { 171.57746887, 133.52525590, 2.18007378 }, { 171.00013648, 134.34175747, 2.19231184 }, { 170.41287762, 135.15114902, 2.20449472 }, { 169.81582454, 135.95334311, 2.21662141 }, { 169.20911048, 136.74825563, 2.22869093 }, { 168.59286966, 137.53580577, 2.24070230 }, { 167.96723714, 138.31591606, 2.25265457 }, { 167.33234878, 139.08851232, 2.26454679 }, { 166.68834111, 139.85352373, 2.27637801 }, { 166.03535129, 140.61088279, 2.28814730 }, { 165.37351701, 141.36052536, 2.29985376 }, { 164.70297642, 142.10239058, 2.31149646 }, { 164.02386801, 142.83642097, 2.32307452 }, { 163.33633060, 143.56256232, 2.33458705 }, { 162.64050319, 144.28076376, 2.34603319 }, { 161.93652494, 144.99097769, 2.35741207 }, { 161.22453505, 145.69315981, 2.36872285 }, { 160.50467271, 146.38726909, 2.37996470 }, { 159.77707702, 147.07326771, 2.39113679 }, { 159.04188692, 147.75112112, 2.40223832 }, { 158.29924111, 148.42079795, 2.41326850 }, { 157.54927797, 149.08227001, 2.42422653 }, { 156.79213553, 149.73551227, 2.43511166 }, { 156.02795135, 150.38050283, 2.44592313 }, { 155.25686252, 151.01722286, 2.45666020 }, { 154.47900551, 151.64565662, 2.46732213 }, { 153.69451618, 152.26579141, 2.47790822 }, { 152.90352968, 152.87761750, 2.48841777 }, { 152.10618043, 153.48112814, 2.49885008 }, { 151.30260199, 154.07631951, 2.50920450 }, { 150.49292707, 154.66319064, 2.51948035 }, { 149.67728746, 155.24174346, 2.52967701 }, { 148.85581395, 155.81198267, 2.53979383 }, { 148.02863632, 156.37391573, 2.54983021 }, { 147.19588324, 156.92755284, 2.55978555 }, { 146.35768227, 157.47290686, 2.56965926 }, { 145.51415979, 158.00999330, 2.57945077 }, { 144.66544095, 158.53883021, 2.58915954 }, { 143.81164966, 159.05943823, 2.59878502 }, { 142.95290850, 159.57184045, 2.60832669 }, { 142.08933872, 160.07606242, 2.61778404 }, { 141.22106020, 160.57213206, 2.62715658 }, { 140.34819139, 161.06007964, 2.63644384 }, { 139.47084929, 161.53993774, 2.64564535 }, { 138.58914944, 162.01174114, 2.65476066 }, { 137.70320585, 162.47552683, 2.66378935 }, { 136.81313101, 162.93133394, 2.67273101 }, { 135.91903584, 163.37920367, 2.68158524 }, { 135.02102966, 163.81917924, 2.69035165 }, { 134.11922021, 164.25130588, 2.69902989 }, { 133.21371356, 164.67563071, 2.70761959 }, { 132.30461416, 165.09220275, 2.71612044 }, { 131.39202478, 165.50107281, 2.72453211 }, { 130.47604651, 165.90229348, 2.73285431 }, { 129.55677873, 166.29591908, 2.74108674 }, { 128.63431913, 166.68200554, 2.74922916 }, { 127.70876366, 167.06061045, 2.75728129 }, { 126.78020656, 167.43179291, 2.76524292 }, { 125.84874030, 167.79561355, 2.77311382 }, { 124.91445564, 168.15213442, 2.78089379 }, { 123.97744157, 168.50141898, 2.78858266 }, { 123.03778533, 168.84353204, 2.79618024 }, { 122.09557241, 169.17853968, 2.80368640 }, { 121.15088654, 169.50650924, 2.81110100 }, { 120.20380971, 169.82750924, 2.81842393 }, { 119.25442213, 170.14160932, 2.82565508 }, { 118.30280228, 170.44888025, 2.83279437 }, { 117.34902690, 170.74939380, 2.83984174 }, { 116.39317099, 171.04322274, 2.84679714 }, { 115.43530781, 171.33044079, 2.85366054 }, { 114.47550891, 171.61112254, 2.86043191 }, { 113.51384412, 171.88534346, 2.86711127 }, { 112.55038157, 172.15317977, 2.87369864 }, { 111.58518769, 172.41470849, 2.88019404 }, { 110.61832726, 172.67000730, 2.88659753 }, { 109.64986336, 172.91915457, 2.89290919 }, { 108.67985745, 173.16222927, 2.89912909 }, { 107.70836934, 173.39931094, 2.90525735 }, { 106.73545722, 173.63047966, 2.91129408 }, { 105.76117769, 173.85581599, 2.91723942 }, { 104.78558577, 174.07540091, 2.92309353 }, { 103.80873489, 174.28931584, 2.92885657 }, { 102.83067696, 174.49764253, 2.93452873 }, { 101.85146236, 174.70046305, 2.94011022 }, { 100.87113995, 174.89785978, 2.94560126 }, { 99.88975713, 175.08991530, 2.95100208 }, { 98.90735982, 175.27671244, 2.95631295 }, { 97.92399250, 175.45833415, 2.96153413 }, { 96.93969824, 175.63486354, 2.96666590 }, { 95.95451873, 175.80638381, 2.97170858 }, { 94.96849426, 175.97297822, 2.97666249 }, { 93.98166379, 176.13473004, 2.98152795 }, { 92.99406495, 176.29172254, 2.98630533 }, { 92.00573410, 176.44403896, 2.99099498 }, { 91.01670629, 176.59176244, 2.99559731 }, { 90.02701534, 176.73497603, 3.00011271 }, { 89.03669386, 176.87376263, 3.00454159 }, { 88.04577324, 177.00820499, 3.00888439 }, { 87.05428371, 177.13838565, 3.01314155 }, { 86.06225436, 177.26438691, 3.01731356 }, { 85.06971315, 177.38629083, 3.02140087 }, { 84.07668697, 177.50417917, 3.02540400 }, { 83.08320161, 177.61813340, 3.02932344 }, { 82.08928185, 177.72823464, 3.03315974 }, { 81.09495144, 177.83456364, 3.03691343 }, { 80.10023313, 177.93720075, 3.04058506 }, { 79.10514875, 178.03622594, 3.04417522 }, { 78.10971914, 178.13171870, 3.04768448 }, { 77.11396426, 178.22375808, 3.05111346 }, { 76.11790319, 178.31242263, 3.05446277 }, { 75.12155413, 178.39779041, 3.05773303 }, { 74.12493445, 178.47993892, 3.06092490 }, { 73.12806073, 178.55894512, 3.06403904 }, { 72.13094875, 178.63488540, 3.06707613 }, { 71.13361353, 178.70783555, 3.07003684 }, { 70.13606935, 178.77787073, 3.07292190 }, { 69.13832981, 178.84506548, 3.07573200 }, { 68.14040777, 178.90949368, 3.07846789 }, { 67.14231548, 178.97122853, 3.08113031 }, { 66.14406453, 179.03034254, 3.08372002 }, { 65.14566587, 179.08690752, 3.08623779 }, { 64.14712989, 179.14099453, 3.08868440 }, { 63.14846640, 179.19267391, 3.09106065 }, { 62.14968465, 179.24201521, 3.09336736 }, { 61.15079336, 179.28908722, 3.09560534 }, { 60.15180075, 179.33395793, 3.09777544 }, { 59.15271456, 179.37669451, 3.09987851 }, { 58.15354205, 179.41736333, 3.10191539 }, { 57.15429004, 179.45602989, 3.10388698 }, { 56.15496493, 179.49275885, 3.10579414 }, { 55.15557270, 179.52761400, 3.10763779 }, { 54.15611894, 179.56065824, 3.10941883 }, { 53.15660888, 179.59195358, 3.11113818 }, { 52.15704740, 179.62156111, 3.11279677 }, { 51.15743902, 179.64954102, 3.11439554 }, { 50.15778796, 179.67595253, 3.11593546 }, { 49.15809814, 179.70085395, 3.11741747 }, { 48.15837318, 179.72430260, 3.11884257 }, { 47.15861644, 179.74635485, 3.12021174 }, { 46.15883101, 179.76706606, 3.12152596 }, { 45.15901975, 179.78649063, 3.12278626 }, { 44.15918529, 179.80468192, 3.12399364 }, { 43.15933003, 179.82169231, 3.12514913 }, { 42.15945619, 179.83757312, 3.12625377 }, { 41.15956579, 179.85237466, 3.12730861 }, { 40.15966066, 179.86614618, 3.12831468 }, { 39.15974249, 179.87893589, 3.12927307 }, { 38.15981280, 179.89079091, 3.13018484 }, { 37.15987296, 179.90175730, 3.13105107 }, { 36.15992423, 179.91188005, 3.13187286 }, { 35.15996771, 179.92120304, 3.13265129 }, { 34.16000442, 179.92976905, 3.13338747 }, { 33.16003526, 179.93761978, 3.13408252 }, { 32.16006103, 179.94479577, 3.13473756 }, { 31.16008243, 179.95133647, 3.13535371 }, { 30.16010011, 179.95728018, 3.13593211 }, { 29.16011462, 179.96266410, 3.13647390 }, { 28.16012644, 179.96752423, 3.13698023 }, { 27.16013600, 179.97189545, 3.13745226 }, { 26.16014368, 179.97581148, 3.13789114 }, { 25.16014979, 179.97930489, 3.13829805 }, { 24.16015460, 179.98240704, 3.13867415 }, { 23.16015837, 179.98514814, 3.13902063 }, { 22.16016127, 179.98755723, 3.13933868 }, { 21.16016349, 179.98966213, 3.13962947 }, { 20.16016516, 179.99148950, 3.13989421 }, { 19.16016641, 179.99306478, 3.14013410 }, { 18.16016732, 179.99441221, 3.14035033 }, { 17.16016797, 179.99555485, 3.14054412 }, { 16.16016843, 179.99651452, 3.14071669 }, { 15.16016875, 179.99731183, 3.14086924 }, { 14.16016897, 179.99796618, 3.14100300 }, { 13.16016911, 179.99849574, 3.14111919 }, { 12.16016920, 179.99891747, 3.14121904 }, { 11.16016925, 179.99924708, 3.14130378 }, { 10.16016928, 179.99949906, 3.14137464 }, { 9.16016930, 179.99968667, 3.14143286 }, { 8.16016931, 179.99982193, 3.14147967 }, { 7.16016931, 179.99991562, 3.14151631 }, { 6.16016932, 179.99997727, 3.14154403 }, { 5.16016932, 180.00001518, 3.14156407 }, { 4.16016932, 180.00003641, 3.14157768 }, { 3.16016932, 180.00004676, 3.14158609 }, { 2.16016932, 180.00005079, 3.14159056 }, { 1.16016932, 180.00005182, 3.14159233 }, { 0.00000000, 180.00000000, 3.14159265 }, };
		Position ret;
		if (index < 0) {
			ret = Position(0 + interval * index, 0, 0);
		} else if (index > size() - 1) {
			Position end(data[size()][0], data[size()][1], data[size()][2]);
			ret = end
					+ Position((index - size()) * interval * cos(end.theta),
							(index - size()) * interval * sin(end.theta), 0);
		} else {
			ret = Position(data[index][0], data[index][1], data[index][2]);
		}
		if (mirror)
			return ret.mirror_x();
		return ret;
	}
};

class MoveAction {
public:
	MoveAction(Buzzer *bz, Motor *mt, Encoders *enc, MPU6500 *mpu, Reflector *rfl, WallDetector *wd,
			SpeedController *sc) :
			bz(bz), mt(mt), enc(enc), mpu(mpu), rfl(rfl), wd(wd), sc(sc), thread(
			PRIORITY_MOVE_ACTION, STACK_SIZE_MOVE_ACTION) {
		set_params(600);
		ticker.attach_us(this, &MoveAction::isr, MOVE_ACTION_PERIOD);
	}
	enum ACTION {
		START_STEP, START_INIT, GO_STRAIGHT, TURN_LEFT_90, TURN_RIGHT_90, RETURN, STOP,
	};
	enum FAST_ACTION {
		FAST_GO_STRAIGHT,
		FAST_GO_HALF,
		FAST_GO_DIAGONAL,
		FAST_TURN_LEFT_45,
		FAST_TURN_RIGHT_45,
		FAST_TURN_LEFT_45R,
		FAST_TURN_RIGHT_45R,
		FAST_TURN_LEFT_45_45,
		FAST_TURN_RIGHT_45_45,
		FAST_TURN_LEFT_90,
		FAST_TURN_RIGHT_90,
		FAST_TURN_LEFT_135,
		FAST_TURN_RIGHT_135,
		FAST_TURN_LEFT_135R,
		FAST_TURN_RIGHT_135R,
		FAST_TURN_LEFT_180,
		FAST_TURN_RIGHT_180,
	};
	struct Operation {
		enum ACTION action;
		int num;
	};
	const char*
	action_string(enum ACTION action) {
		static const char name[][32] =
				{ "start_step", "start_init", "go_straight", "turn_left_90", "turn_right_90", "return", "stop", };
		return name[action];
	}
	void enable() {
		rfl->enable();
		sc->enable();
		if (path.size() > 0) {
			thread.start(this, &MoveAction::fastRun);
		} else {
			thread.start(this, &MoveAction::searchRun);
		}
	}
	void disable() {
		thread.terminate();
		sc->disable();
		rfl->disable();
		while (q.size()) {
			q.pop();
		}
		path.clear();
	}
	void set_action(FAST_ACTION action) {
		path.push_back(action);
	}
	void set_action(std::vector<FAST_ACTION> actions) {
		path = actions;
	}
	void set_action(enum ACTION action, int num = 1) {
		struct Operation operation;
		operation.action = action;
		operation.num = num;
		q.push(operation);
	}
	void set_params(float fast_speed) {
		this->fast_speed = fast_speed;
	}
	void set_params_relative(float add) {
		this->fast_speed += add;
	}
	int actions() const {
		return q.size();
	}
	void printPosition(const char* name) {
		printf("%s\t", name);
//		printf("Ori:(%06.1f, %06.1f, %06.3f)\t", origin.x, origin.y, origin.theta);
//		printf("Abs:(%06.1f, %06.1f, %06.3f)\t", sc->getPosition().x, sc->getPosition().y,
//				sc->getPosition().theta);
		printf("Rel:(%06.1f, %06.1f, %06.3f)\t", getRelativePosition().x, getRelativePosition().y,
				getRelativePosition().theta);
		printf("\n");
	}
	Position getRelativePosition() {
		return (sc->getPosition() - origin).rotate(-origin.theta);
	}
	void updateOrigin(Position passed) {
		origin += passed.rotate(origin.theta);
	}
	void setPosition(Position pos = Position(90, 6 + 24, M_PI / 2)) {
		origin = pos;
		sc->getPosition() = pos;
	}
	void fixPosition(Position pos) {
		sc->getPosition() -= pos;
	}
private:
	Buzzer *bz;
	Motor *mt;
	Encoders *enc;
	MPU6500 *mpu;
	Reflector *rfl;
	WallDetector *wd;
	SpeedController *sc;
	Thread thread;
	Ticker ticker;
	Timer timer;
	float fast_speed;
	Position origin;
	std::queue<struct Operation> q;
	std::vector<FAST_ACTION> path;

	void isr() {
		thread.signal_set(0x01);
	}
	void wall_avoid() {
#if WALL_AVOID_ENABLED
		void wall_attach()
		{
			if (wd->wall().side[0])
			{
				sc->position.y -= wd->wall_difference().side[0] * 0.00001 * sc->actual().trans;
			}
			if (wd->wall().side[1])
			{
				sc->position.y += wd->wall_difference().side[1] * 0.00001 * sc->actual().trans;
			}
		}
#endif
	}
	void wall_attach() {
#if WALL_ATTACH_ENABLED
		if (wd->wall().flont[0] && wd->wall().flont[1])
		{
			while (1)
			{
				float trans = wd->wall_difference().flont[0] + wd->wall_difference().flont[1];
				float rot = wd->wall_difference().flont[1] - wd->wall_difference().flont[0];
				sc->set_target(trans * 100, rot * 10);
				if (fabs(trans) < 0.1f && fabs(rot) < 0.1f) break;
				Thread::wait(1);
			}
			sc->set_target(0, 0);
			fixPosition(Position(getRelativePosition().x, 0, 0).rotate(origin.theta));
		}
#endif
	}
	void turn(float target_angle, float speed) {
		const float accel = 64 * M_PI;
		timer.reset();
		timer.start();
		while (1) {
			Thread::signal_wait(0x01);
			if (fabs(sc->actual.rot) > speed)
				break;
			if (target_angle > 0) {
				sc->set_target(0, timer.read() * accel);
			} else {
				sc->set_target(0, -timer.read() * accel);
			}
		}
		while (1) {
			Thread::signal_wait(0x01);
			if (fabs(sc->actual.rot) < 0.2)
				break;
			float extra = target_angle - getRelativePosition().theta;
			float target_speed = sqrt(2 * accel * fabs(extra));
			target_speed = (target_speed > speed) ? speed : target_speed;
			if (extra > 0) {
				sc->set_target(0, target_speed);
			} else {
				sc->set_target(0, -target_speed);
			}
		}
		updateOrigin(Position(0, 0, target_angle));
	}
	void straight_x(const float distance, const float v_max, const float v_end) {
		const float accel = 6000;
		const float decel = 3000;
		Trajectory st;
		timer.reset();
		timer.start();
		float v_start = sc->actual.trans;
		bool isAccel = true;
		while (1) {
			if (getRelativePosition().x > distance - 10.0f)
				break;
			if (v_end < 1.0f && sc->actual.trans < 1.0f)
				break;
			Thread::signal_wait(0x01);
			float extra = distance - getRelativePosition().x;
			float velocity = sqrt(2 * decel * fabs(extra) + v_end * v_end);
			if (extra < 0)
				velocity = -velocity;
			if (velocity < sc->actual.trans)
				isAccel = false;
			if (isAccel)
				velocity = v_start + timer.read() * accel;
			if (velocity > v_max)
				velocity = v_max;
			Position dir = st.getNextDir(getRelativePosition(), velocity);
			sc->set_target(dir.x, dir.theta * TRAJECTORY_PROP_GAIN);
			wall_avoid();
		}
		sc->set_target(v_end, 0);
//		printPosition("Straight");
		updateOrigin(Position(distance, 0, 0));
	}
	template<class C>
	void trace(C tr, const float velocity) {
		int cnt = 0;
		float integral = 0;
		while (1) {
			if (tr.getRemain() < 5.0f)
				break;
			Thread::signal_wait(0x01);
			Position dir = tr.getNextDir(getRelativePosition(), velocity);
			integral += dir.theta * TRAJECTORY_INT_GAIN * MOVE_ACTION_PERIOD / 1000000;
			sc->set_target(dir.x, (dir.theta + integral) * TRAJECTORY_PROP_GAIN);
			if (cnt++ % 20 == 0) {
//				printf("%.1f\t%.3f\n", dir.x, dir.theta);
			}
		}
		sc->set_target(velocity, 0);
		updateOrigin(tr.getEndPosition());
	}
	void searchRun() {
		const float velocity = 400;
		const float omega = 4 * M_PI;
		while (1) {
			float integral = 0;
			while (q.empty()) {
				Thread::signal_wait(0x01);
				Position cur = getRelativePosition();
				int look_ahead = 30;
				Position dir = (Position(cur.x + look_ahead) - cur).rotate(-cur.theta);
				dir.theta = atan2f(dir.y, dir.x);
				dir *= velocity / look_ahead;
				integral += dir.theta * TRAJECTORY_INT_GAIN * MOVE_ACTION_PERIOD / 1000000;
				sc->set_target(dir.x, (dir.theta + integral) * TRAJECTORY_PROP_GAIN);
			}
			struct Operation operation = q.front();
			enum ACTION action = operation.action;
			int num = operation.num;
			printf("%s: %d\n", action_string(action), num);
			printPosition("Start");
			switch (action) {
			case START_STEP:
				setPosition();
				straight_x(180 - 24 - 6, velocity, velocity);
				break;
			case START_INIT:
				straight_x(90, velocity, 0);
				wall_attach();
				turn(M_PI / 2, omega);
				wall_attach();
				turn(M_PI / 2, omega);
				for (int i = 0; i < 100; i++) {
					sc->set_target(-i, 0);
					Thread::wait(1);
				}
				Thread::wait(200);
				sc->disable();
				mt->drive(-60, -60);
				Thread::wait(400);
				mt->drive(0, 0);
				disable();
				break;
			case GO_STRAIGHT:
				straight_x(180 * num, velocity, velocity);
				break;
			case TURN_LEFT_90:
				for (int i = 0; i < num; i++) {
					Curve90 tr(false);
					trace(tr, velocity);
				}
				break;
			case TURN_RIGHT_90:
				for (int i = 0; i < num; i++) {
					Curve90 tr(true);
					trace(tr, velocity);
				}
				break;
			case RETURN:
				straight_x(90, velocity, 0);
				if (mpu->angle.z > 0) {
					wall_attach();
					turn(-M_PI / 2, omega);
					wall_attach();
					turn(-M_PI / 2, omega);
				} else {
					wall_attach();
					turn(M_PI / 2, omega);
					wall_attach();
					turn(M_PI / 2, omega);
				}
				straight_x(90, velocity, velocity);
				break;
			case STOP:
				straight_x(90, velocity, 0);
				wall_attach();
				disable();
				break;
			}
			q.pop();
			printPosition("End");
		}
	}
	void fastRun() {
		const float velocity = 600;
		setPosition();
		straight_x(180 - 24 - 6, velocity, velocity);
		printPosition("S");
		int path_index = 0;
		while (1) {
			if (path_index > (int) path.size() - 1)
				break;
			switch (path[path_index]) {
			case FAST_TURN_LEFT_45: {
				C45 tr(false);
				trace(tr, velocity);
				straight_x(37.280794107585571, velocity, velocity);
			}
				break;
			case FAST_TURN_RIGHT_45: {
				C45 tr(true);
				trace(tr, velocity);
				straight_x(37.280794107585571, velocity, velocity);
			}
				break;
			case FAST_TURN_LEFT_45R: {
				straight_x(37.280794107585571, velocity, velocity);
				C45 tr(false);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_RIGHT_45R: {
				straight_x(37.280794107585571, velocity, velocity);
				C45 tr(true);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_LEFT_45_45: {
				C4545 tr(false);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_RIGHT_45_45: {
				C4545 tr(true);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_LEFT_90: {
				C90 tr(false);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_RIGHT_90: {
				C90 tr(true);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_LEFT_135: {
				C135 tr(false);
				trace(tr, velocity);
				straight_x(74.560731431502333, velocity, velocity);
			}
				break;
			case FAST_TURN_RIGHT_135: {
				C135 tr(true);
				trace(tr, velocity);
				straight_x(74.560731431502333, velocity, velocity);
			}
				break;
			case FAST_TURN_LEFT_135R: {
				straight_x(74.560731431502333, velocity, velocity);
				C135 tr(false);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_RIGHT_135R: {
				straight_x(74.560731431502333, velocity, velocity);
				C135 tr(true);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_LEFT_180: {
				C180 tr(false);
				trace(tr, velocity);
			}
				break;
			case FAST_TURN_RIGHT_180: {
				C180 tr(true);
				trace(tr, velocity);
			}
				break;
			case FAST_GO_STRAIGHT:
				straight_x(180, velocity, velocity);
				break;
			case FAST_GO_HALF:
				straight_x(90, velocity, velocity);
				break;
			case FAST_GO_DIAGONAL:
				straight_x(63.639610306789280, velocity, velocity);
				break;
			}
		}

		printPosition("E");
		straight_x(90, velocity, 0);
		wall_attach();
		sc->set_target(0, 0);
		Thread::wait(100);
		disable();
	}
};

#endif /* MOVEACTION_H_ */
